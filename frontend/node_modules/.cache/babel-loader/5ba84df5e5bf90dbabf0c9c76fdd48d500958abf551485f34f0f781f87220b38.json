{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import{photosAPI}from'../services/api';import toast from'react-hot-toast';import{Camera,Upload,X,Image as ImageIcon}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PhotoUpload=_ref=>{let{rentalId,photoType,onPhotosChange}=_ref;const[photos,setPhotos]=useState([]);const[uploading,setUploading]=useState(false);const[dragActive,setDragActive]=useState(false);const fileInputRef=useRef(null);const cameraInputRef=useRef(null);// Carica foto esistenti all'avvio\nuseEffect(()=>{if(rentalId){loadExistingPhotos();}},[rentalId,photoType]);const loadExistingPhotos=async()=>{try{const response=await photosAPI.getByRental(rentalId,photoType);const existingPhotos=response.data.data.map(photo=>({id:photo.id,url:photosAPI.getUrl(photo.id),filename:photo.file_name}));setPhotos(existingPhotos);if(onPhotosChange){onPhotosChange(existingPhotos);}}catch(error){console.error('Errore caricamento foto esistenti:',error);}};const handleFileSelect=async files=>{if(!files||files.length===0)return;// Validazione rental_id\nif(!rentalId){toast.error('ID noleggio mancante. Salva prima il noleggio.');return;}setUploading(true);const uploadedPhotos=[];const failedUploads=[];try{for(const file of Array.from(files)){// Validazione tipo file\nif(!file.type.startsWith('image/')){failedUploads.push(\"\".concat(file.name,\": non \\xE8 un'immagine valida\"));continue;}// Validazione dimensione (5MB)\nif(file.size>5*1024*1024){failedUploads.push(\"\".concat(file.name,\": troppo grande (max 5MB)\"));continue;}// Crea FormData\nconst formData=new FormData();formData.append('photo',file);formData.append('rental_id',rentalId);formData.append('photo_type',photoType);try{// Upload singolo\nconst response=await photosAPI.upload(formData);const uploadedPhoto=response.data.data;uploadedPhotos.push(uploadedPhoto);// Aggiungi preview locale\nconst reader=new FileReader();reader.onload=e=>{setPhotos(prev=>[...prev,{id:uploadedPhoto.photo_id,url:e.target.result,filename:uploadedPhoto.filename}]);};reader.readAsDataURL(file);}catch(uploadError){var _uploadError$response,_uploadError$response2;console.error(\"Errore upload \".concat(file.name,\":\"),uploadError);failedUploads.push(\"\".concat(file.name,\": \").concat(((_uploadError$response=uploadError.response)===null||_uploadError$response===void 0?void 0:(_uploadError$response2=_uploadError$response.data)===null||_uploadError$response2===void 0?void 0:_uploadError$response2.message)||'errore sconosciuto'));}}// Mostra risultati\nif(uploadedPhotos.length>0){toast.success(\"\".concat(uploadedPhotos.length,\" foto caricate con successo!\"));if(onPhotosChange){onPhotosChange([...photos,...uploadedPhotos]);}}if(failedUploads.length>0){console.error('Upload falliti:',failedUploads);toast.error(\"\".concat(failedUploads.length,\" upload falliti. Vedi console per dettagli.\"));}}catch(error){console.error('Errore upload foto:',error);toast.error('Errore durante il caricamento delle foto');}finally{setUploading(false);// Reset input file\nif(fileInputRef.current)fileInputRef.current.value='';if(cameraInputRef.current)cameraInputRef.current.value='';}};const handleDrag=e=>{e.preventDefault();e.stopPropagation();if(e.type==='dragenter'||e.type==='dragover'){setDragActive(true);}else if(e.type==='dragleave'){setDragActive(false);}};const handleDrop=e=>{e.preventDefault();e.stopPropagation();setDragActive(false);if(e.dataTransfer.files&&e.dataTransfer.files.length>0){handleFileSelect(e.dataTransfer.files);}};const handleDeletePhoto=async photoId=>{if(!window.confirm('Sei sicuro di voler eliminare questa foto?')){return;}try{await photosAPI.delete(photoId);setPhotos(prev=>prev.filter(p=>p.id!==photoId));toast.success('Foto eliminata con successo');if(onPhotosChange){const updatedPhotos=photos.filter(p=>p.id!==photoId);onPhotosChange(updatedPhotos);}}catch(error){var _error$response,_error$response$data;console.error('Errore eliminazione foto:',error);toast.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Errore durante l\\'eliminazione della foto');}};const openFileDialog=()=>{var _fileInputRef$current;(_fileInputRef$current=fileInputRef.current)===null||_fileInputRef$current===void 0?void 0:_fileInputRef$current.click();};const openCamera=()=>{var _cameraInputRef$curre;(_cameraInputRef$curre=cameraInputRef.current)===null||_cameraInputRef$curre===void 0?void 0:_cameraInputRef$curre.click();};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"photo-upload-area \".concat(dragActive?'dragging':''),onDragEnter:handleDrag,onDragLeave:handleDrag,onDragOver:handleDrag,onDrop:handleDrop,onClick:openFileDialog,style:{border:dragActive?'2px dashed #1a4d2e':'2px dashed #dee2e6',borderRadius:'4px',padding:'24px',textAlign:'center',cursor:uploading?'wait':'pointer',transition:'all 0.2s',backgroundColor:dragActive?'#e6f7e9':'#fdfdfd'},children:[/*#__PURE__*/_jsx(ImageIcon,{size:48,color:dragActive?'#1a4d2e':'#6c757d',style:{marginBottom:'16px'}}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'16px',fontWeight:'500',marginBottom:'8px'},children:uploading?'Caricamento in corso...':'Trascina le foto qui o clicca per selezionare'}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'14px',color:'#6c757d',marginBottom:'16px'},children:\"Formati supportati: JPG, PNG, GIF, WEBP (max 5MB per foto)\"}),!uploading&&/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px',justifyContent:'center'},children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:e=>{e.stopPropagation();openFileDialog();},className:\"btn btn-outline-primary btn-sm\",disabled:uploading,children:[/*#__PURE__*/_jsx(Upload,{size:16}),\"Seleziona File\"]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:e=>{e.stopPropagation();openCamera();},className:\"btn btn-outline-secondary btn-sm\",disabled:uploading,children:[/*#__PURE__*/_jsx(Camera,{size:16}),\"Usa Fotocamera\"]})]}),uploading&&/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'16px'},children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner\",style:{width:'30px',height:'30px',margin:'0 auto',borderTopColor:'#1a4d2e'}})})]}),/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,type:\"file\",accept:\"image/*\",multiple:true,style:{display:'none'},onChange:e=>handleFileSelect(e.target.files),disabled:uploading}),/*#__PURE__*/_jsx(\"input\",{ref:cameraInputRef,type:\"file\",accept:\"image/*\",capture:\"environment\",multiple:true,style:{display:'none'},onChange:e=>handleFileSelect(e.target.files),disabled:uploading}),photos.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"photo-grid\",style:{display:'flex',flexWrap:'wrap',gap:'12px',marginTop:'16px'},children:photos.map(photo=>/*#__PURE__*/_jsxs(\"div\",{className:\"photo-item\",style:{position:'relative',width:'100px',height:'100px',overflow:'hidden',borderRadius:'4px',boxShadow:'0 1px 2px 0 rgba(0, 0, 0, 0.05)'},children:[/*#__PURE__*/_jsx(\"img\",{src:photo.url,alt:photo.filename,style:{width:'100%',height:'100%',objectFit:'cover'}}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"photo-item-remove\",onClick:()=>handleDeletePhoto(photo.id),title:\"Elimina foto\",style:{position:'absolute',top:'4px',right:'4px',background:'#dc3545',color:'white',border:'none',borderRadius:'50%',width:'24px',height:'24px',display:'flex',alignItems:'center',justifyContent:'center',cursor:'pointer',opacity:0.8,transition:'opacity 0.2s'},onMouseEnter:e=>e.currentTarget.style.opacity='1',onMouseLeave:e=>e.currentTarget.style.opacity='0.8',children:/*#__PURE__*/_jsx(X,{size:16})})]},photo.id))}),photos.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'16px',padding:'12px',background:'#e8f5e9',borderRadius:'4px',fontSize:'14px',color:'#1a4d2e',textAlign:'center',fontWeight:'500'},children:[\"\\u2713 \",photos.length,\" foto caricate\"]})]});};export default PhotoUpload;","map":{"version":3,"names":["React","useState","useRef","useEffect","photosAPI","toast","Camera","Upload","X","Image","ImageIcon","jsx","_jsx","jsxs","_jsxs","PhotoUpload","_ref","rentalId","photoType","onPhotosChange","photos","setPhotos","uploading","setUploading","dragActive","setDragActive","fileInputRef","cameraInputRef","loadExistingPhotos","response","getByRental","existingPhotos","data","map","photo","id","url","getUrl","filename","file_name","error","console","handleFileSelect","files","length","uploadedPhotos","failedUploads","file","Array","from","type","startsWith","push","concat","name","size","formData","FormData","append","upload","uploadedPhoto","reader","FileReader","onload","e","prev","photo_id","target","result","readAsDataURL","uploadError","_uploadError$response","_uploadError$response2","message","success","current","value","handleDrag","preventDefault","stopPropagation","handleDrop","dataTransfer","handleDeletePhoto","photoId","window","confirm","delete","filter","p","updatedPhotos","_error$response","_error$response$data","openFileDialog","_fileInputRef$current","click","openCamera","_cameraInputRef$curre","children","className","onDragEnter","onDragLeave","onDragOver","onDrop","onClick","style","border","borderRadius","padding","textAlign","cursor","transition","backgroundColor","color","marginBottom","fontSize","fontWeight","display","gap","justifyContent","disabled","marginTop","width","height","margin","borderTopColor","ref","accept","multiple","onChange","capture","flexWrap","position","overflow","boxShadow","src","alt","objectFit","title","top","right","background","alignItems","opacity","onMouseEnter","currentTarget","onMouseLeave"],"sources":["D:/Bncrentcar/frontend/src/components/PhotoUpload.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport { photosAPI } from '../services/api';\r\nimport toast from 'react-hot-toast';\r\nimport { Camera, Upload, X, Image as ImageIcon } from 'lucide-react';\r\n\r\nconst PhotoUpload = ({ rentalId, photoType, onPhotosChange }) => {\r\n  const [photos, setPhotos] = useState([]);\r\n  const [uploading, setUploading] = useState(false);\r\n  const [dragActive, setDragActive] = useState(false);\r\n  const fileInputRef = useRef(null);\r\n  const cameraInputRef = useRef(null);\r\n\r\n  // Carica foto esistenti all'avvio\r\n  useEffect(() => {\r\n    if (rentalId) {\r\n      loadExistingPhotos();\r\n    }\r\n  }, [rentalId, photoType]);\r\n\r\n  const loadExistingPhotos = async () => {\r\n    try {\r\n      const response = await photosAPI.getByRental(rentalId, photoType);\r\n      const existingPhotos = response.data.data.map(photo => ({\r\n        id: photo.id,\r\n        url: photosAPI.getUrl(photo.id),\r\n        filename: photo.file_name,\r\n      }));\r\n      setPhotos(existingPhotos);\r\n      \r\n      if (onPhotosChange) {\r\n        onPhotosChange(existingPhotos);\r\n      }\r\n    } catch (error) {\r\n      console.error('Errore caricamento foto esistenti:', error);\r\n    }\r\n  };\r\n\r\n  const handleFileSelect = async (files) => {\r\n    if (!files || files.length === 0) return;\r\n\r\n    // Validazione rental_id\r\n    if (!rentalId) {\r\n      toast.error('ID noleggio mancante. Salva prima il noleggio.');\r\n      return;\r\n    }\r\n\r\n    setUploading(true);\r\n    const uploadedPhotos = [];\r\n    const failedUploads = [];\r\n\r\n    try {\r\n      for (const file of Array.from(files)) {\r\n        // Validazione tipo file\r\n        if (!file.type.startsWith('image/')) {\r\n          failedUploads.push(`${file.name}: non è un'immagine valida`);\r\n          continue;\r\n        }\r\n\r\n        // Validazione dimensione (5MB)\r\n        if (file.size > 5 * 1024 * 1024) {\r\n          failedUploads.push(`${file.name}: troppo grande (max 5MB)`);\r\n          continue;\r\n        }\r\n\r\n        // Crea FormData\r\n        const formData = new FormData();\r\n        formData.append('photo', file);\r\n        formData.append('rental_id', rentalId);\r\n        formData.append('photo_type', photoType);\r\n\r\n        try {\r\n          // Upload singolo\r\n          const response = await photosAPI.upload(formData);\r\n          const uploadedPhoto = response.data.data;\r\n          \r\n          uploadedPhotos.push(uploadedPhoto);\r\n          \r\n          // Aggiungi preview locale\r\n          const reader = new FileReader();\r\n          reader.onload = (e) => {\r\n            setPhotos(prev => [...prev, {\r\n              id: uploadedPhoto.photo_id,\r\n              url: e.target.result,\r\n              filename: uploadedPhoto.filename,\r\n            }]);\r\n          };\r\n          reader.readAsDataURL(file);\r\n          \r\n        } catch (uploadError) {\r\n          console.error(`Errore upload ${file.name}:`, uploadError);\r\n          failedUploads.push(`${file.name}: ${uploadError.response?.data?.message || 'errore sconosciuto'}`);\r\n        }\r\n      }\r\n\r\n      // Mostra risultati\r\n      if (uploadedPhotos.length > 0) {\r\n        toast.success(`${uploadedPhotos.length} foto caricate con successo!`);\r\n        \r\n        if (onPhotosChange) {\r\n          onPhotosChange([...photos, ...uploadedPhotos]);\r\n        }\r\n      }\r\n\r\n      if (failedUploads.length > 0) {\r\n        console.error('Upload falliti:', failedUploads);\r\n        toast.error(`${failedUploads.length} upload falliti. Vedi console per dettagli.`);\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('Errore upload foto:', error);\r\n      toast.error('Errore durante il caricamento delle foto');\r\n    } finally {\r\n      setUploading(false);\r\n      \r\n      // Reset input file\r\n      if (fileInputRef.current) fileInputRef.current.value = '';\r\n      if (cameraInputRef.current) cameraInputRef.current.value = '';\r\n    }\r\n  };\r\n\r\n  const handleDrag = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    \r\n    if (e.type === 'dragenter' || e.type === 'dragover') {\r\n      setDragActive(true);\r\n    } else if (e.type === 'dragleave') {\r\n      setDragActive(false);\r\n    }\r\n  };\r\n\r\n  const handleDrop = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setDragActive(false);\r\n    \r\n    if (e.dataTransfer.files && e.dataTransfer.files.length > 0) {\r\n      handleFileSelect(e.dataTransfer.files);\r\n    }\r\n  };\r\n\r\n  const handleDeletePhoto = async (photoId) => {\r\n    if (!window.confirm('Sei sicuro di voler eliminare questa foto?')) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await photosAPI.delete(photoId);\r\n      \r\n      setPhotos(prev => prev.filter(p => p.id !== photoId));\r\n      toast.success('Foto eliminata con successo');\r\n      \r\n      if (onPhotosChange) {\r\n        const updatedPhotos = photos.filter(p => p.id !== photoId);\r\n        onPhotosChange(updatedPhotos);\r\n      }\r\n      \r\n    } catch (error) {\r\n      console.error('Errore eliminazione foto:', error);\r\n      toast.error(error.response?.data?.message || 'Errore durante l\\'eliminazione della foto');\r\n    }\r\n  };\r\n\r\n  const openFileDialog = () => {\r\n    fileInputRef.current?.click();\r\n  };\r\n\r\n  const openCamera = () => {\r\n    cameraInputRef.current?.click();\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      {/* Upload Area */}\r\n      <div\r\n        className={`photo-upload-area ${dragActive ? 'dragging' : ''}`}\r\n        onDragEnter={handleDrag}\r\n        onDragLeave={handleDrag}\r\n        onDragOver={handleDrag}\r\n        onDrop={handleDrop}\r\n        onClick={openFileDialog}\r\n        style={{\r\n          border: dragActive ? '2px dashed #1a4d2e' : '2px dashed #dee2e6',\r\n          borderRadius: '4px',\r\n          padding: '24px',\r\n          textAlign: 'center',\r\n          cursor: uploading ? 'wait' : 'pointer',\r\n          transition: 'all 0.2s',\r\n          backgroundColor: dragActive ? '#e6f7e9' : '#fdfdfd',\r\n        }}\r\n      >\r\n        <ImageIcon \r\n          size={48} \r\n          color={dragActive ? '#1a4d2e' : '#6c757d'} \r\n          style={{ marginBottom: '16px' }} \r\n        />\r\n        \r\n        <p style={{ fontSize: '16px', fontWeight: '500', marginBottom: '8px' }}>\r\n          {uploading ? 'Caricamento in corso...' : 'Trascina le foto qui o clicca per selezionare'}\r\n        </p>\r\n        \r\n        <p style={{ fontSize: '14px', color: '#6c757d', marginBottom: '16px' }}>\r\n          Formati supportati: JPG, PNG, GIF, WEBP (max 5MB per foto)\r\n        </p>\r\n        \r\n        {!uploading && (\r\n          <div style={{ display: 'flex', gap: '12px', justifyContent: 'center' }}>\r\n            <button\r\n              type=\"button\"\r\n              onClick={(e) => {\r\n                e.stopPropagation();\r\n                openFileDialog();\r\n              }}\r\n              className=\"btn btn-outline-primary btn-sm\"\r\n              disabled={uploading}\r\n            >\r\n              <Upload size={16} />\r\n              Seleziona File\r\n            </button>\r\n            \r\n            <button\r\n              type=\"button\"\r\n              onClick={(e) => {\r\n                e.stopPropagation();\r\n                openCamera();\r\n              }}\r\n              className=\"btn btn-outline-secondary btn-sm\"\r\n              disabled={uploading}\r\n            >\r\n              <Camera size={16} />\r\n              Usa Fotocamera\r\n            </button>\r\n          </div>\r\n        )}\r\n\r\n        {uploading && (\r\n          <div style={{ marginTop: '16px' }}>\r\n            <div \r\n              className=\"spinner\" \r\n              style={{ \r\n                width: '30px', \r\n                height: '30px', \r\n                margin: '0 auto',\r\n                borderTopColor: '#1a4d2e'\r\n              }}\r\n            />\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Hidden File Inputs */}\r\n      <input\r\n        ref={fileInputRef}\r\n        type=\"file\"\r\n        accept=\"image/*\"\r\n        multiple\r\n        style={{ display: 'none' }}\r\n        onChange={(e) => handleFileSelect(e.target.files)}\r\n        disabled={uploading}\r\n      />\r\n      \r\n      <input\r\n        ref={cameraInputRef}\r\n        type=\"file\"\r\n        accept=\"image/*\"\r\n        capture=\"environment\"\r\n        multiple\r\n        style={{ display: 'none' }}\r\n        onChange={(e) => handleFileSelect(e.target.files)}\r\n        disabled={uploading}\r\n      />\r\n\r\n      {/* Photo Grid */}\r\n      {photos.length > 0 && (\r\n        <div \r\n          className=\"photo-grid\"\r\n          style={{\r\n            display: 'flex',\r\n            flexWrap: 'wrap',\r\n            gap: '12px',\r\n            marginTop: '16px'\r\n          }}\r\n        >\r\n          {photos.map((photo) => (\r\n            <div \r\n              key={photo.id} \r\n              className=\"photo-item\"\r\n              style={{\r\n                position: 'relative',\r\n                width: '100px',\r\n                height: '100px',\r\n                overflow: 'hidden',\r\n                borderRadius: '4px',\r\n                boxShadow: '0 1px 2px 0 rgba(0, 0, 0, 0.05)'\r\n              }}\r\n            >\r\n              <img \r\n                src={photo.url} \r\n                alt={photo.filename}\r\n                style={{\r\n                  width: '100%',\r\n                  height: '100%',\r\n                  objectFit: 'cover'\r\n                }}\r\n              />\r\n              \r\n              <button\r\n                type=\"button\"\r\n                className=\"photo-item-remove\"\r\n                onClick={() => handleDeletePhoto(photo.id)}\r\n                title=\"Elimina foto\"\r\n                style={{\r\n                  position: 'absolute',\r\n                  top: '4px',\r\n                  right: '4px',\r\n                  background: '#dc3545',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  borderRadius: '50%',\r\n                  width: '24px',\r\n                  height: '24px',\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  justifyContent: 'center',\r\n                  cursor: 'pointer',\r\n                  opacity: 0.8,\r\n                  transition: 'opacity 0.2s'\r\n                }}\r\n                onMouseEnter={(e) => e.currentTarget.style.opacity = '1'}\r\n                onMouseLeave={(e) => e.currentTarget.style.opacity = '0.8'}\r\n              >\r\n                <X size={16} />\r\n              </button>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {photos.length > 0 && (\r\n        <div style={{\r\n          marginTop: '16px',\r\n          padding: '12px',\r\n          background: '#e8f5e9',\r\n          borderRadius: '4px',\r\n          fontSize: '14px',\r\n          color: '#1a4d2e',\r\n          textAlign: 'center',\r\n          fontWeight: '500'\r\n        }}>\r\n          ✓ {photos.length} foto caricate\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PhotoUpload;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}