{"ast":null,"code":"import _objectSpread from\"D:/Bncrentcar/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef}from'react';import{useNavigate}from'react-router-dom';import{rentalsAPI,customersAPI,vehiclesAPI}from'../services/api';import toast from'react-hot-toast';import PhotoUpload from'./PhotoUpload';import{ArrowLeft,ArrowRight,Save,User,Car,Calendar,DollarSign,CreditCard,Shield,Camera,CheckCircle,UserPlus,FileText// ✅ CORREZIONE: Importa FileText\n}from'lucide-react';// --- INIZIO: Implementazione Mock SignaturePad ---\n// NOTA: Per un funzionamento reale su mobile, DEVI installare e utilizzare una libreria \n// come 'react-signature-canvas' e decommentare la riga di importazione.\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const SignaturePad=_ref=>{let{ref,penColor,canvasProps,onEnd}=_ref;// Implementazione minima per non interrompere il codice.\nReact.useImperativeHandle(ref,()=>({clear:()=>console.log('Signature cleared (simulation)'),isEmpty:()=>false,getTrimmedCanvas:()=>({toDataURL:()=>'data:image/png;base64,SIMULATED_SIGNATURE'})}));// Usa un elemento canvas standard come placeholder\nreturn/*#__PURE__*/_jsx(\"canvas\",_objectSpread(_objectSpread({},canvasProps),{},{style:_objectSpread(_objectSpread({},canvasProps.style),{},{backgroundColor:'#f5f5f5'}),onMouseUp:onEnd,onTouchEnd:onEnd,children:\"Disegna qui (Solo Placeholder: installa `react-signature-canvas`)\"}));};// --- FINE: Implementazione Mock SignaturePad ---\nconst NewRental=()=>{const navigate=useNavigate();const[currentStep,setCurrentStep]=useState(1);const[loading,setLoading]=useState(false);const[customers,setCustomers]=useState([]);const[vehicles,setVehicles]=useState([]);// Riferimento al canvas per la firma\nconst sigCanvas=useRef({});// ✅ STATO COMPLETO CON VALORI DI DEFAULT E FIRMA\nconst[formData,setFormData]=useState({// Step 1: Cliente\ncustomer_id:'',// Step 2: Veicolo\nvehicle_id:'',// Step 3: Date e Dettagli Noleggio\npickup_date:new Date().toISOString().slice(0,16),// Data/ora attuali\nexpected_return_date:'',// Da calcolare o inserire\npickup_location:'BNC Energy Rent Car',pickup_fuel_level:'100',// 100%\npickup_km:'',pickup_damages:'Nessun danno',pickup_notes:'',// Step 4: Conducente Aggiuntivo\nadditional_driver_name:'',additional_driver_birth_place:'',additional_driver_birth_date:'',additional_driver_license:'',additional_driver_license_issued_by:'',additional_driver_license_issue_date:'',additional_driver_license_expiry:'',// Step 5: Tariffe e Costi\ndaily_rate:'',deposit_amount:'0',// Cauzione\ntotal_days:1,km_included:'Illimitati',// ✅ VALORI DI DEFAULT RICHIESTI\ndelivery_cost:'0',fuel_charge:'2.50',// Carburante a litro\nafter_hours_charge:'20.00',// Addebito fuori orario\nkm_extra_cost:'0.56',// Costo unitario KM extra\nextras_charge:'0',// Costo extra (seggiolini, navigatore, ecc.)\n// Step 6: Finanziario\nextra_km_charge:'0',// Totale extra km\nfranchise_charge:'0',// Coperture aggiuntive\ndiscount:'0',subtotal:0,total_amount:0,// Step 7: Coperture Assicurative\nfranchise_theft:'0',franchise_damage:'0',franchise_rca:'0',// Step 8: Pagamento\npayment_method:'Contanti',deposit_method:'Contanti',cc_holder_name:'',cc_type:'VISA',cc_number_masked:'',cc_expiry:'',// Step 9: Riepilogo Dati (Nessun campo in questo step)\n// Step 10: Consensi e Firma\ncontract_signed:false,privacy_consent:false,marketing_consent:false,customer_signature:'',// ✅ NUOVO CAMPO\n// Step 11: Foto\nrental_id:null});// Funzioni di calcolo (omesse per brevità, ma essenziali in un'app reale)\n// ...\nuseEffect(()=>{loadInitialData();},[]);const loadInitialData=async()=>{try{// Carica clienti e veicoli\nconst[customersRes,vehiclesRes]=await Promise.all([customersAPI.getAll(),vehiclesAPI.getAll({available_only:true})]);setCustomers(customersRes.data.data);setVehicles(vehiclesRes.data.data.vehicles);// Imposta la data di riconsegna prevista 24h dopo il ritiro\nconst initialPickup=new Date();const initialReturn=new Date(initialPickup.getTime()+24*60*60*1000);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{pickup_date:initialPickup.toISOString().slice(0,16),expected_return_date:initialReturn.toISOString().slice(0,16)}));}catch(error){toast.error('Errore nel caricamento dati iniziali.');}};const handleChange=e=>{const{name,value,type,checked}=e.target;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:type==='checkbox'?checked:value}));};// ✅ NUOVE FUNZIONI PER GESTIRE LA FIRMA\nconst handleSignatureClear=()=>{sigCanvas.current.clear();setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{customer_signature:''}));};const handleSignatureEnd=()=>{// Simula l'acquisizione della firma Base64\nif(sigCanvas.current.isEmpty()){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{customer_signature:''}));}else{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{customer_signature:sigCanvas.current.getTrimmedCanvas().toDataURL('image/png')}));}};// ✅ LOGICA DI VALIDAZIONE AGGIORNATA PER FIRMA OBBLIGATORIA\nconst validateStep=step=>{switch(step){case 1:// Cliente\nif(!formData.customer_id){toast.error('Seleziona un cliente.');return false;}break;case 2:// Veicolo\nif(!formData.vehicle_id){toast.error('Seleziona un veicolo.');return false;}break;case 3:// Date\nif(!formData.pickup_date||!formData.expected_return_date){toast.error('Date di ritiro e riconsegna sono obbligatorie.');return false;}// Aggiungere logica per controllare se data riconsegna è >= data ritiro\nbreak;case 10:// Consensi e Firma\nif(!formData.contract_signed||!formData.privacy_consent){toast.error('Devi accettare il contratto e l\\'informativa sulla privacy.');return false;}if(!formData.customer_signature){// NUOVA VALIDAZIONE\ntoast.error('La firma del cliente è obbligatoria.');return false;}break;default:break;}return true;};const handleNext=()=>{if(validateStep(currentStep)){setCurrentStep(prev=>prev+1);}};const handlePrevious=()=>{setCurrentStep(prev=>prev-1);};const handleSubmit=async()=>{if(!validateStep(10))return;try{setLoading(true);const rentalData=_objectSpread(_objectSpread({},formData),{},{// Conversione esplicita dei campi numerici al server\ndaily_rate:parseFloat(formData.daily_rate)||0,deposit_amount:parseFloat(formData.deposit_amount)||0,total_days:parseInt(formData.total_days)||1,delivery_cost:parseFloat(formData.delivery_cost)||0,fuel_charge:parseFloat(formData.fuel_charge)||0,after_hours_charge:parseFloat(formData.after_hours_charge)||0,km_extra_cost:parseFloat(formData.km_extra_cost)||0,// Nuovo campo inviato\nextras_charge:parseFloat(formData.extras_charge)||0,extra_km_charge:parseFloat(formData.extra_km_charge)||0,franchise_charge:parseFloat(formData.franchise_charge)||0,discount:parseFloat(formData.discount)||0,subtotal:formData.subtotal,total_amount:formData.total_amount,franchise_theft:parseFloat(formData.franchise_theft)||0,franchise_damage:parseFloat(formData.franchise_damage)||0,franchise_rca:parseFloat(formData.franchise_rca)||0,// Firma Base64\ncustomer_signature:formData.customer_signature});const response=await rentalsAPI.create(rentalData);const newRentalId=response.data.data.id;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{rental_id:newRentalId}));setCurrentStep(11);// Passa allo step Foto\ntoast.success('Noleggio creato con successo! Continua con le foto.');}catch(error){var _error$response,_error$response$data;console.error('Errore creazione noleggio:',error);toast.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Errore durante la creazione del noleggio.');}finally{setLoading(false);}};const handleFinish=()=>{if(formData.rental_id){navigate(\"/rentals/\".concat(formData.rental_id));}else{navigate('/rentals');}};const steps=[{num:1,name:'Cliente',icon:/*#__PURE__*/_jsx(User,{size:20})},{num:2,name:'Veicolo',icon:/*#__PURE__*/_jsx(Car,{size:20})},{num:3,name:'Date/Ritiro',icon:/*#__PURE__*/_jsx(Calendar,{size:20})},{num:4,name:'Conducente Add.',icon:/*#__PURE__*/_jsx(UserPlus,{size:20})},{num:5,name:'Tariffe/Costi',icon:/*#__PURE__*/_jsx(DollarSign,{size:20})},{num:6,name:'Riepilogo Costi',icon:/*#__PURE__*/_jsx(DollarSign,{size:20})},{num:7,name:'Coperture',icon:/*#__PURE__*/_jsx(Shield,{size:20})},{num:8,name:'Pagamento',icon:/*#__PURE__*/_jsx(CreditCard,{size:20})},{num:9,name:'Riepilogo',icon:/*#__PURE__*/_jsx(FileText,{size:20})},// L'errore era qui\n{num:10,name:'Firma/Consensi',icon:/*#__PURE__*/_jsx(CheckCircle,{size:20})},{num:11,name:'Foto Iniziali',icon:/*#__PURE__*/_jsx(Camera,{size:20})}];const renderStep1=()=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginBottom:'24px'},children:\"Selezione Cliente\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"customer_id\",value:formData.customer_id,onChange:handleChange,className:\"form-control\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Seleziona un Cliente\"}),customers.map(c=>/*#__PURE__*/_jsxs(\"option\",{value:c.id,children:[c.full_name,\" (\",c.tax_code,\")\"]},c.id))]}),formData.customer_id&&customers.find(c=>c.id===parseInt(formData.customer_id))&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'20px',padding:'15px',border:'1px solid #ccc',borderRadius:'4px'},children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Dettagli Cliente\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Nome:\"}),\" \",customers.find(c=>c.id===parseInt(formData.customer_id)).full_name]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Email:\"}),\" \",customers.find(c=>c.id===parseInt(formData.customer_id)).email]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Telefono:\"}),\" \",customers.find(c=>c.id===parseInt(formData.customer_id)).phone]})]})]});const renderStep2=()=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginBottom:'24px'},children:\"Selezione Veicolo\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"vehicle_id\",value:formData.vehicle_id,onChange:handleChange,className:\"form-control\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Seleziona un Veicolo\"}),vehicles.map(v=>/*#__PURE__*/_jsxs(\"option\",{value:v.id,children:[v.brand,\" \",v.model,\" (\",v.license_plate,\") - \",v.category_name]},v.id))]}),formData.vehicle_id&&vehicles.find(v=>v.id===parseInt(formData.vehicle_id))&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'20px',padding:'15px',border:'1px solid #ccc',borderRadius:'4px'},children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Dettagli Veicolo\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Targa:\"}),\" \",vehicles.find(v=>v.id===parseInt(formData.vehicle_id)).license_plate]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Categoria:\"}),\" \",vehicles.find(v=>v.id===parseInt(formData.vehicle_id)).category_name]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Km Attuali:\"}),\" \",vehicles.find(v=>v.id===parseInt(formData.vehicle_id)).current_km,\" km\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Tariffa Base:\"}),\" \",vehicles.find(v=>v.id===parseInt(formData.vehicle_id)).daily_rate,\" \\u20AC/giorno\"]})]})]});const renderStep3=()=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginBottom:'24px'},children:\"Dettagli Ritiro e Riconsegna\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Data/Ora Ritiro Effettivo\"}),/*#__PURE__*/_jsx(\"input\",{type:\"datetime-local\",name:\"pickup_date\",value:formData.pickup_date,onChange:handleChange,className:\"form-control\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Data/Ora Riconsegna Prevista\"}),/*#__PURE__*/_jsx(\"input\",{type:\"datetime-local\",name:\"expected_return_date\",value:formData.expected_return_date,onChange:handleChange,className:\"form-control\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Luogo di Ritiro\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"pickup_location\",value:formData.pickup_location,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Livello Carburante al Ritiro (%)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"pickup_fuel_level\",value:formData.pickup_fuel_level,onChange:handleChange,className:\"form-control\",min:\"0\",max:\"100\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Km al Ritiro (OBBLIGATORIO)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"pickup_km\",value:formData.pickup_km,onChange:handleChange,className:\"form-control\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Danni Visibili al Ritiro\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"pickup_damages\",value:formData.pickup_damages,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Note di Ritiro\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"pickup_notes\",value:formData.pickup_notes,onChange:handleChange,className:\"form-control\"})]})]});const renderStep4=()=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginBottom:'24px'},children:\"Conducente Aggiuntivo (Opzionale)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Nome Completo\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"additional_driver_name\",value:formData.additional_driver_name,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Luogo di Nascita\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"additional_driver_birth_place\",value:formData.additional_driver_birth_place,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Data di Nascita\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"additional_driver_birth_date\",value:formData.additional_driver_birth_date,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Numero Patente\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"additional_driver_license\",value:formData.additional_driver_license,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Rilasciata da\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"additional_driver_license_issued_by\",value:formData.additional_driver_license_issued_by,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Data Rilascio Patente\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"additional_driver_license_issue_date\",value:formData.additional_driver_license_issue_date,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Data Scadenza Patente\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"additional_driver_license_expiry\",value:formData.additional_driver_license_expiry,onChange:handleChange,className:\"form-control\"})]})]});const renderStep5=()=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginBottom:'24px'},children:\"Tariffe e Costi Base\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Tariffa Giornaliera (\\u20AC)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"daily_rate\",value:formData.daily_rate,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Giorni di Noleggio (Totali)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"total_days\",value:formData.total_days,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Cauzione (\\u20AC)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"deposit_amount\",value:formData.deposit_amount,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Km Inclusi (es. Illimitati o 100km/giorno)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"km_included\",value:formData.km_included,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsx(\"h4\",{style:{marginTop:'30px'},children:\"Costi Aggiuntivi Preimpostati\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Costo Carburante (a litro - default: **2.50** \\u20AC)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"fuel_charge\",value:formData.fuel_charge,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Addebito Fuori Orario (default: **20.00** \\u20AC)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"after_hours_charge\",value:formData.after_hours_charge,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Costo KM Extra (a km - default: **0.56** \\u20AC)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"km_extra_cost\",value:formData.km_extra_cost,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Costo Consegna/Ritiro (\\u20AC)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"delivery_cost\",value:formData.delivery_cost,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Costi Extra Generici (es. Seggiolino, Navigatore)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"extras_charge\",value:formData.extras_charge,onChange:handleChange,className:\"form-control\"})]})]});const renderStep6=()=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginBottom:'24px'},children:\"Riepilogo Costi e Totali\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Addebito KM Extra Totale (\\u20AC)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"extra_km_charge\",value:formData.extra_km_charge,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Addebito Coperture Aggiuntive Totale (\\u20AC)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"franchise_charge\",value:formData.franchise_charge,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Sconto Applicato (\\u20AC)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"discount\",value:formData.discount,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'30px',padding:'15px',border:'1px solid #007bff',borderRadius:'4px',background:'#e9f5ff'},children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Totali (Calcolati o Inseriti Manualmente)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Subtotale Noleggio (\\u20AC)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"subtotal\",value:formData.subtotal,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Totale Contratto (\\u20AC)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"total_amount\",value:formData.total_amount,onChange:handleChange,className:\"form-control\"})]})]})]});const renderStep7=()=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginBottom:'24px'},children:\"Coperture Assicurative (Franchigie)\"}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'14px',color:'#6c757d'},children:\"Valori franchigie in caso di sinistro/furto/incendio.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Franchigia Furto/Incendio (\\u20AC)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"franchise_theft\",value:formData.franchise_theft,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Franchigia Danni (\\u20AC)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"franchise_damage\",value:formData.franchise_damage,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Massimale RCA (\\u20AC)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"franchise_rca\",value:formData.franchise_rca,onChange:handleChange,className:\"form-control\"})]})]});const renderStep8=()=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginBottom:'24px'},children:\"Dettagli Pagamento\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Metodo Pagamento Totale\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"payment_method\",value:formData.payment_method,onChange:handleChange,className:\"form-control\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"Contanti\",children:\"Contanti\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Carta di Credito\",children:\"Carta di Credito\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Bonifico\",children:\"Bonifico\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Metodo Pagamento Cauzione\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"deposit_method\",value:formData.deposit_method,onChange:handleChange,className:\"form-control\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"Contanti\",children:\"Contanti\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Carta di Credito\",children:\"Carta di Credito\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Assegno\",children:\"Assegno\"})]})]}),/*#__PURE__*/_jsx(\"h4\",{style:{marginTop:'30px'},children:\"Dati Carta di Credito (Se usata)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Nome Intestatario CC\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"cc_holder_name\",value:formData.cc_holder_name,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Tipo Carta\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"cc_type\",value:formData.cc_type,onChange:handleChange,className:\"form-control\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"VISA\",children:\"VISA\"}),/*#__PURE__*/_jsx(\"option\",{value:\"MasterCard\",children:\"MasterCard\"}),/*#__PURE__*/_jsx(\"option\",{value:\"AMEX\",children:\"AMEX\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Diners\",children:\"Diners\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Numero Carta (Masked)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"cc_number_masked\",value:formData.cc_number_masked,onChange:handleChange,className:\"form-control\",placeholder:\"**** **** **** 1234\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Scadenza (MM/AA)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"cc_expiry\",value:formData.cc_expiry,onChange:handleChange,className:\"form-control\",placeholder:\"05/26\"})]})]});const renderStep9=()=>{var _customers$find,_vehicles$find,_vehicles$find2,_vehicles$find3;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginBottom:'24px'},children:\"Riepilogo Finale del Contratto\"}),/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px',border:'1px solid #007bff',borderRadius:'8px',background:'#f8f9fa'},children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Informazioni Essenziali\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Cliente:\"}),\" \",(_customers$find=customers.find(c=>c.id===parseInt(formData.customer_id)))===null||_customers$find===void 0?void 0:_customers$find.full_name]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Veicolo:\"}),\" \",(_vehicles$find=vehicles.find(v=>v.id===parseInt(formData.vehicle_id)))===null||_vehicles$find===void 0?void 0:_vehicles$find.brand,\" \",(_vehicles$find2=vehicles.find(v=>v.id===parseInt(formData.vehicle_id)))===null||_vehicles$find2===void 0?void 0:_vehicles$find2.model,\" (\",(_vehicles$find3=vehicles.find(v=>v.id===parseInt(formData.vehicle_id)))===null||_vehicles$find3===void 0?void 0:_vehicles$find3.license_plate,\")\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Ritiro:\"}),\" \",new Date(formData.pickup_date).toLocaleString()]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Riconsegna Prevista:\"}),\" \",new Date(formData.expected_return_date).toLocaleString()]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Totale Contratto:\"}),\" **\",parseFloat(formData.total_amount).toFixed(2),\" \\u20AC**\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Cauzione:\"}),\" \",parseFloat(formData.deposit_amount).toFixed(2),\" \\u20AC\"]}),/*#__PURE__*/_jsx(\"h5\",{style:{marginTop:'15px'},children:\"Dettagli Costi Extra:\"}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsxs(\"li\",{children:[\"**Carburante a Litro:** \",formData.fuel_charge,\" \\u20AC\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"**Addebito Fuori Orario:** \",formData.after_hours_charge,\" \\u20AC\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"**Costo KM Extra (unitario):** \",formData.km_extra_cost,\" \\u20AC/km\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"**Totale Extra:** \",(parseFloat(formData.delivery_cost)+parseFloat(formData.extras_charge)).toFixed(2),\" \\u20AC\"]})]})]}),/*#__PURE__*/_jsx(\"p\",{style:{marginTop:'20px',color:'#dc3545'},children:\"**AVVISO:** La pressione del tasto \\\"Crea Noleggio\\\" finalizzer\\xE0 il contratto e lo render\\xE0 attivo.\"})]});};// ✅ STEP 10: CONSENSI E FIRMA (AGGIUNTO SIGNATURE PAD)\nconst renderStep10=()=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginBottom:'24px'},children:\"Consensi e Firma Contratto\"}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'30px'},children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Firma del Cliente\"}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'14px',color:'#6c757d'},children:\"Apponi la firma con il tuo dito o stilo sul dispositivo mobile.\"}),/*#__PURE__*/_jsx(\"div\",{style:{border:'1px solid #ccc',borderRadius:'4px',maxWidth:'400px',margin:'0 auto',background:'#fff'},children:/*#__PURE__*/_jsx(SignaturePad,{ref:sigCanvas,penColor:\"black\",canvasProps:{width:400,// Larghezza fissa\nheight:200,// Altezza fissa\nclassName:'sigCanvas',style:{border:'1px solid transparent',borderRadius:'4px',touchAction:'none'// Essenziale per un buon supporto touch\n}},onEnd:handleSignatureEnd})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'center',marginTop:'10px',gap:'10px'},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleSignatureClear,className:\"btn btn-sm btn-outline-danger\",children:\"Cancella Firma\"}),formData.customer_signature&&/*#__PURE__*/_jsx(\"span\",{style:{color:'#1a4d2e',fontSize:'14px',lineHeight:'30px'},children:\"\\u2705 Firma acquisita\"})]}),!formData.customer_signature&&/*#__PURE__*/_jsx(\"p\",{style:{color:'#dc3545',textAlign:'center',marginTop:'10px'},children:\"*Firma obbligatoria per procedere.\"})]}),/*#__PURE__*/_jsx(\"h4\",{children:\"Dichiarazioni e Consensi\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group form-check\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",id:\"contract_signed\",name:\"contract_signed\",checked:formData.contract_signed,onChange:handleChange,className:\"form-check-input\"}),/*#__PURE__*/_jsx(\"label\",{className:\"form-check-label\",htmlFor:\"contract_signed\",children:\"Dichiaro di aver letto e accettato integralmente il contratto di noleggio e le condizioni generali.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group form-check\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",id:\"privacy_consent\",name:\"privacy_consent\",checked:formData.privacy_consent,onChange:handleChange,className:\"form-check-input\"}),/*#__PURE__*/_jsx(\"label\",{className:\"form-check-label\",htmlFor:\"privacy_consent\",children:\"Acconsento al trattamento dei dati personali (OBBLIGATORIO).\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group form-check\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",id:\"marketing_consent\",name:\"marketing_consent\",checked:formData.marketing_consent,onChange:handleChange,className:\"form-check-input\"}),/*#__PURE__*/_jsx(\"label\",{className:\"form-check-label\",htmlFor:\"marketing_consent\",children:\"Acconsento a ricevere comunicazioni promozionali e di marketing.\"})]})]});const renderStep11=()=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginBottom:'24px'},children:\"Foto Iniziali del Veicolo\"}),formData.rental_id?/*#__PURE__*/_jsx(PhotoUpload,{rentalId:formData.rental_id,photoType:\"pickup\"// Funzione per aggiornare la lista delle foto, se necessario\n,onPhotosChange:photos=>console.log('Pickup photos updated:',photos)}):/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-warning\",children:\"Noleggio non ancora creato. Torna indietro e premi \\\"Crea Noleggio\\\".\"}),/*#__PURE__*/_jsx(\"p\",{style:{marginTop:'20px',color:'#6c757d'},children:\"Carica qui le foto che documentano lo stato del veicolo al momento del ritiro.\"})]});const renderStepContent=()=>{switch(currentStep){case 1:return renderStep1();case 2:return renderStep2();case 3:return renderStep3();case 4:return renderStep4();case 5:return renderStep5();case 6:return renderStep6();case 7:return renderStep7();case 8:return renderStep8();case 9:return renderStep9();case 10:return renderStep10();case 11:return renderStep11();default:return/*#__PURE__*/_jsx(\"div\",{children:\"Step non trovato\"});}};return/*#__PURE__*/_jsx(\"div\",{className:\"container\",style:{paddingTop:'30px'},children:/*#__PURE__*/_jsx(\"div\",{className:\"row justify-content-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-10\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card shadow-sm\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header bg-primary text-white\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"mb-0\",children:\"Nuovo Contratto di Noleggio\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'space-between',marginBottom:'30px',overflowX:'auto',paddingBottom:'10px'},children:steps.map(step=>/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',minWidth:'100px',cursor:'pointer',opacity:currentStep===step.num?1:0.6,borderBottom:currentStep===step.num?'3px solid #007bff':'3px solid transparent',paddingBottom:'5px'},onClick:()=>setCurrentStep(step.num),children:[/*#__PURE__*/_jsx(\"div\",{style:{display:'inline-flex',alignItems:'center',justifyContent:'center',width:'30px',height:'30px',borderRadius:'50%',background:currentStep>=step.num?'#007bff':'#ccc',color:'white',marginBottom:'5px'},children:step.icon}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'12px',fontWeight:'bold',color:currentStep>=step.num?'#007bff':'#6c757d'},children:step.name})]},step.num))}),/*#__PURE__*/_jsx(\"div\",{style:{minHeight:'400px',padding:'20px',border:'1px solid #eee',borderRadius:'4px'},children:renderStepContent()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-footer\",style:{display:'flex',justifyContent:'space-between',padding:'15px 20px',backgroundColor:'#f8f9fa'},children:[currentStep>1&&currentStep<11&&/*#__PURE__*/_jsxs(\"button\",{onClick:handlePrevious,className:\"btn btn-secondary\",children:[/*#__PURE__*/_jsx(ArrowLeft,{size:18}),\"Indietro\"]}),currentStep<10&&/*#__PURE__*/_jsxs(\"button\",{onClick:handleNext,className:\"btn btn-primary\",style:{marginLeft:currentStep>1?'':'auto'},children:[\"Avanti\",/*#__PURE__*/_jsx(ArrowRight,{size:18})]}),currentStep===10&&/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,className:\"btn btn-success\",disabled:loading||!formData.contract_signed||!formData.privacy_consent||!formData.customer_signature,style:{marginLeft:currentStep>1?'auto':'auto'},children:loading?'Creazione...':/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Save,{size:18}),\"Crea Noleggio\"]})}),currentStep===11&&/*#__PURE__*/_jsxs(\"button\",{onClick:handleFinish,className:\"btn btn-success\",style:{marginLeft:'auto'},children:[/*#__PURE__*/_jsx(CheckCircle,{size:18}),\"Completa\"]})]})]})})})});};export default NewRental;","map":{"version":3,"names":["React","useState","useEffect","useRef","useNavigate","rentalsAPI","customersAPI","vehiclesAPI","toast","PhotoUpload","ArrowLeft","ArrowRight","Save","User","Car","Calendar","DollarSign","CreditCard","Shield","Camera","CheckCircle","UserPlus","FileText","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","SignaturePad","_ref","ref","penColor","canvasProps","onEnd","useImperativeHandle","clear","console","log","isEmpty","getTrimmedCanvas","toDataURL","_objectSpread","style","backgroundColor","onMouseUp","onTouchEnd","children","NewRental","navigate","currentStep","setCurrentStep","loading","setLoading","customers","setCustomers","vehicles","setVehicles","sigCanvas","formData","setFormData","customer_id","vehicle_id","pickup_date","Date","toISOString","slice","expected_return_date","pickup_location","pickup_fuel_level","pickup_km","pickup_damages","pickup_notes","additional_driver_name","additional_driver_birth_place","additional_driver_birth_date","additional_driver_license","additional_driver_license_issued_by","additional_driver_license_issue_date","additional_driver_license_expiry","daily_rate","deposit_amount","total_days","km_included","delivery_cost","fuel_charge","after_hours_charge","km_extra_cost","extras_charge","extra_km_charge","franchise_charge","discount","subtotal","total_amount","franchise_theft","franchise_damage","franchise_rca","payment_method","deposit_method","cc_holder_name","cc_type","cc_number_masked","cc_expiry","contract_signed","privacy_consent","marketing_consent","customer_signature","rental_id","loadInitialData","customersRes","vehiclesRes","Promise","all","getAll","available_only","data","initialPickup","initialReturn","getTime","prev","error","handleChange","e","name","value","type","checked","target","handleSignatureClear","current","handleSignatureEnd","validateStep","step","handleNext","handlePrevious","handleSubmit","rentalData","parseFloat","parseInt","response","create","newRentalId","id","success","_error$response","_error$response$data","message","handleFinish","concat","steps","num","icon","size","renderStep1","marginBottom","onChange","className","required","map","c","full_name","tax_code","find","marginTop","padding","border","borderRadius","email","phone","renderStep2","v","brand","model","license_plate","category_name","current_km","renderStep3","min","max","renderStep4","renderStep5","renderStep6","background","renderStep7","fontSize","color","renderStep8","placeholder","renderStep9","_customers$find","_vehicles$find","_vehicles$find2","_vehicles$find3","toLocaleString","toFixed","renderStep10","maxWidth","margin","width","height","touchAction","display","justifyContent","gap","onClick","lineHeight","textAlign","htmlFor","renderStep11","rentalId","photoType","onPhotosChange","photos","renderStepContent","paddingTop","overflowX","paddingBottom","minWidth","cursor","opacity","borderBottom","alignItems","fontWeight","minHeight","marginLeft","disabled"],"sources":["D:/Bncrentcar/frontend/src/components/NewRental.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { rentalsAPI, customersAPI, vehiclesAPI } from '../services/api';\r\nimport toast from 'react-hot-toast';\r\nimport PhotoUpload from './PhotoUpload';\r\nimport {\r\n  ArrowLeft,\r\n  ArrowRight,\r\n  Save,\r\n  User,\r\n  Car,\r\n  Calendar,\r\n  DollarSign,\r\n  CreditCard,\r\n  Shield,\r\n  Camera,\r\n  CheckCircle,\r\n  UserPlus,\r\n  FileText // ✅ CORREZIONE: Importa FileText\r\n} from 'lucide-react';\r\n\r\n// --- INIZIO: Implementazione Mock SignaturePad ---\r\n// NOTA: Per un funzionamento reale su mobile, DEVI installare e utilizzare una libreria \r\n// come 'react-signature-canvas' e decommentare la riga di importazione.\r\nconst SignaturePad = ({ ref, penColor, canvasProps, onEnd }) => {\r\n    // Implementazione minima per non interrompere il codice.\r\n    React.useImperativeHandle(ref, () => ({\r\n        clear: () => console.log('Signature cleared (simulation)'),\r\n        isEmpty: () => false, \r\n        getTrimmedCanvas: () => ({ toDataURL: () => 'data:image/png;base64,SIMULATED_SIGNATURE' }),\r\n    }));\r\n    \r\n    // Usa un elemento canvas standard come placeholder\r\n    return (\r\n        <canvas {...canvasProps} style={{...canvasProps.style, backgroundColor: '#f5f5f5'}} \r\n            onMouseUp={onEnd} onTouchEnd={onEnd} \r\n        >\r\n            Disegna qui (Solo Placeholder: installa `react-signature-canvas`)\r\n        </canvas>\r\n    );\r\n};\r\n// --- FINE: Implementazione Mock SignaturePad ---\r\n\r\nconst NewRental = () => {\r\n  const navigate = useNavigate();\r\n  const [currentStep, setCurrentStep] = useState(1);\r\n  const [loading, setLoading] = useState(false);\r\n  \r\n  const [customers, setCustomers] = useState([]);\r\n  const [vehicles, setVehicles] = useState([]);\r\n  \r\n  // Riferimento al canvas per la firma\r\n  const sigCanvas = useRef({}); \r\n  \r\n  // ✅ STATO COMPLETO CON VALORI DI DEFAULT E FIRMA\r\n  const [formData, setFormData] = useState({\r\n    // Step 1: Cliente\r\n    customer_id: '',\r\n    \r\n    // Step 2: Veicolo\r\n    vehicle_id: '',\r\n    \r\n    // Step 3: Date e Dettagli Noleggio\r\n    pickup_date: new Date().toISOString().slice(0, 16), // Data/ora attuali\r\n    expected_return_date: '', // Da calcolare o inserire\r\n    pickup_location: 'BNC Energy Rent Car',\r\n    pickup_fuel_level: '100', // 100%\r\n    pickup_km: '',\r\n    pickup_damages: 'Nessun danno',\r\n    pickup_notes: '',\r\n\r\n    // Step 4: Conducente Aggiuntivo\r\n    additional_driver_name: '',\r\n    additional_driver_birth_place: '',\r\n    additional_driver_birth_date: '',\r\n    additional_driver_license: '',\r\n    additional_driver_license_issued_by: '',\r\n    additional_driver_license_issue_date: '',\r\n    additional_driver_license_expiry: '',\r\n\r\n    // Step 5: Tariffe e Costi\r\n    daily_rate: '',\r\n    deposit_amount: '0', // Cauzione\r\n    total_days: 1,\r\n    km_included: 'Illimitati',\r\n    \r\n    // ✅ VALORI DI DEFAULT RICHIESTI\r\n    delivery_cost: '0', \r\n    fuel_charge: '2.50', // Carburante a litro\r\n    after_hours_charge: '20.00', // Addebito fuori orario\r\n    km_extra_cost: '0.56', // Costo unitario KM extra\r\n    extras_charge: '0', // Costo extra (seggiolini, navigatore, ecc.)\r\n\r\n    // Step 6: Finanziario\r\n    extra_km_charge: '0', // Totale extra km\r\n    franchise_charge: '0', // Coperture aggiuntive\r\n    discount: '0',\r\n    subtotal: 0,\r\n    total_amount: 0,\r\n\r\n    // Step 7: Coperture Assicurative\r\n    franchise_theft: '0',\r\n    franchise_damage: '0',\r\n    franchise_rca: '0',\r\n    \r\n    // Step 8: Pagamento\r\n    payment_method: 'Contanti', \r\n    deposit_method: 'Contanti',\r\n    cc_holder_name: '',\r\n    cc_type: 'VISA',\r\n    cc_number_masked: '',\r\n    cc_expiry: '',\r\n    \r\n    // Step 9: Riepilogo Dati (Nessun campo in questo step)\r\n    \r\n    // Step 10: Consensi e Firma\r\n    contract_signed: false,\r\n    privacy_consent: false,\r\n    marketing_consent: false,\r\n    customer_signature: '', // ✅ NUOVO CAMPO\r\n    \r\n    // Step 11: Foto\r\n    rental_id: null,\r\n  });\r\n\r\n  // Funzioni di calcolo (omesse per brevità, ma essenziali in un'app reale)\r\n  // ...\r\n\r\n  useEffect(() => {\r\n    loadInitialData();\r\n  }, []);\r\n\r\n  const loadInitialData = async () => {\r\n    try {\r\n      // Carica clienti e veicoli\r\n      const [customersRes, vehiclesRes] = await Promise.all([\r\n        customersAPI.getAll(),\r\n        vehiclesAPI.getAll({ available_only: true })\r\n      ]);\r\n      setCustomers(customersRes.data.data);\r\n      setVehicles(vehiclesRes.data.data.vehicles);\r\n      \r\n      // Imposta la data di riconsegna prevista 24h dopo il ritiro\r\n      const initialPickup = new Date();\r\n      const initialReturn = new Date(initialPickup.getTime() + 24 * 60 * 60 * 1000);\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        pickup_date: initialPickup.toISOString().slice(0, 16),\r\n        expected_return_date: initialReturn.toISOString().slice(0, 16)\r\n      }));\r\n      \r\n    } catch (error) {\r\n      toast.error('Errore nel caricamento dati iniziali.');\r\n    }\r\n  };\r\n  \r\n  const handleChange = (e) => {\r\n    const { name, value, type, checked } = e.target;\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      [name]: type === 'checkbox' ? checked : value\r\n    }));\r\n  };\r\n\r\n  // ✅ NUOVE FUNZIONI PER GESTIRE LA FIRMA\r\n  const handleSignatureClear = () => {\r\n    sigCanvas.current.clear();\r\n    setFormData(prev => ({ ...prev, customer_signature: '' }));\r\n  };\r\n\r\n  const handleSignatureEnd = () => {\r\n    // Simula l'acquisizione della firma Base64\r\n    if (sigCanvas.current.isEmpty()) {\r\n      setFormData(prev => ({ ...prev, customer_signature: '' }));\r\n    } else {\r\n      setFormData(prev => ({ \r\n        ...prev, \r\n        customer_signature: sigCanvas.current.getTrimmedCanvas().toDataURL('image/png') \r\n      }));\r\n    }\r\n  };\r\n\r\n\r\n  // ✅ LOGICA DI VALIDAZIONE AGGIORNATA PER FIRMA OBBLIGATORIA\r\n  const validateStep = (step) => {\r\n    switch (step) {\r\n      case 1: // Cliente\r\n        if (!formData.customer_id) {\r\n          toast.error('Seleziona un cliente.');\r\n          return false;\r\n        }\r\n        break;\r\n      case 2: // Veicolo\r\n        if (!formData.vehicle_id) {\r\n          toast.error('Seleziona un veicolo.');\r\n          return false;\r\n        }\r\n        break;\r\n      case 3: // Date\r\n        if (!formData.pickup_date || !formData.expected_return_date) {\r\n          toast.error('Date di ritiro e riconsegna sono obbligatorie.');\r\n          return false;\r\n        }\r\n        // Aggiungere logica per controllare se data riconsegna è >= data ritiro\r\n        break;\r\n      case 10: // Consensi e Firma\r\n        if (!formData.contract_signed || !formData.privacy_consent) {\r\n          toast.error('Devi accettare il contratto e l\\'informativa sulla privacy.');\r\n          return false;\r\n        }\r\n        if (!formData.customer_signature) { // NUOVA VALIDAZIONE\r\n          toast.error('La firma del cliente è obbligatoria.');\r\n          return false;\r\n        }\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  const handleNext = () => {\r\n    if (validateStep(currentStep)) {\r\n      setCurrentStep(prev => prev + 1);\r\n    }\r\n  };\r\n\r\n  const handlePrevious = () => {\r\n    setCurrentStep(prev => prev - 1);\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    if (!validateStep(10)) return;\r\n\r\n    try {\r\n      setLoading(true);\r\n      \r\n      const rentalData = {\r\n        ...formData,\r\n        // Conversione esplicita dei campi numerici al server\r\n        daily_rate: parseFloat(formData.daily_rate) || 0,\r\n        deposit_amount: parseFloat(formData.deposit_amount) || 0,\r\n        total_days: parseInt(formData.total_days) || 1,\r\n        delivery_cost: parseFloat(formData.delivery_cost) || 0,\r\n        fuel_charge: parseFloat(formData.fuel_charge) || 0,\r\n        after_hours_charge: parseFloat(formData.after_hours_charge) || 0,\r\n        km_extra_cost: parseFloat(formData.km_extra_cost) || 0, // Nuovo campo inviato\r\n        extras_charge: parseFloat(formData.extras_charge) || 0,\r\n        extra_km_charge: parseFloat(formData.extra_km_charge) || 0,\r\n        franchise_charge: parseFloat(formData.franchise_charge) || 0,\r\n        discount: parseFloat(formData.discount) || 0,\r\n        subtotal: formData.subtotal,\r\n        total_amount: formData.total_amount,\r\n        franchise_theft: parseFloat(formData.franchise_theft) || 0,\r\n        franchise_damage: parseFloat(formData.franchise_damage) || 0,\r\n        franchise_rca: parseFloat(formData.franchise_rca) || 0,\r\n        \r\n        // Firma Base64\r\n        customer_signature: formData.customer_signature, \r\n      };\r\n\r\n      const response = await rentalsAPI.create(rentalData);\r\n      const newRentalId = response.data.data.id;\r\n      \r\n      setFormData(prev => ({ ...prev, rental_id: newRentalId }));\r\n      setCurrentStep(11); // Passa allo step Foto\r\n      toast.success('Noleggio creato con successo! Continua con le foto.');\r\n      \r\n    } catch (error) {\r\n      console.error('Errore creazione noleggio:', error);\r\n      toast.error(error.response?.data?.message || 'Errore durante la creazione del noleggio.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleFinish = () => {\r\n    if (formData.rental_id) {\r\n      navigate(`/rentals/${formData.rental_id}`);\r\n    } else {\r\n      navigate('/rentals');\r\n    }\r\n  };\r\n\r\n  const steps = [\r\n    { num: 1, name: 'Cliente', icon: <User size={20} /> },\r\n    { num: 2, name: 'Veicolo', icon: <Car size={20} /> },\r\n    { num: 3, name: 'Date/Ritiro', icon: <Calendar size={20} /> },\r\n    { num: 4, name: 'Conducente Add.', icon: <UserPlus size={20} /> },\r\n    { num: 5, name: 'Tariffe/Costi', icon: <DollarSign size={20} /> },\r\n    { num: 6, name: 'Riepilogo Costi', icon: <DollarSign size={20} /> },\r\n    { num: 7, name: 'Coperture', icon: <Shield size={20} /> },\r\n    { num: 8, name: 'Pagamento', icon: <CreditCard size={20} /> },\r\n    { num: 9, name: 'Riepilogo', icon: <FileText size={20} /> }, // L'errore era qui\r\n    { num: 10, name: 'Firma/Consensi', icon: <CheckCircle size={20} /> },\r\n    { num: 11, name: 'Foto Iniziali', icon: <Camera size={20} /> },\r\n  ];\r\n\r\n  const renderStep1 = () => (\r\n    <div>\r\n      <h3 style={{ marginBottom: '24px' }}>Selezione Cliente</h3>\r\n      <select\r\n        name=\"customer_id\"\r\n        value={formData.customer_id}\r\n        onChange={handleChange}\r\n        className=\"form-control\"\r\n        required\r\n      >\r\n        <option value=\"\">Seleziona un Cliente</option>\r\n        {customers.map(c => (\r\n          <option key={c.id} value={c.id}>{c.full_name} ({c.tax_code})</option>\r\n        ))}\r\n      </select>\r\n      {formData.customer_id && customers.find(c => c.id === parseInt(formData.customer_id)) && (\r\n        <div style={{ marginTop: '20px', padding: '15px', border: '1px solid #ccc', borderRadius: '4px' }}>\r\n          <h4>Dettagli Cliente</h4>\r\n          <p><strong>Nome:</strong> {customers.find(c => c.id === parseInt(formData.customer_id)).full_name}</p>\r\n          <p><strong>Email:</strong> {customers.find(c => c.id === parseInt(formData.customer_id)).email}</p>\r\n          <p><strong>Telefono:</strong> {customers.find(c => c.id === parseInt(formData.customer_id)).phone}</p>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  const renderStep2 = () => (\r\n    <div>\r\n      <h3 style={{ marginBottom: '24px' }}>Selezione Veicolo</h3>\r\n      <select\r\n        name=\"vehicle_id\"\r\n        value={formData.vehicle_id}\r\n        onChange={handleChange}\r\n        className=\"form-control\"\r\n        required\r\n      >\r\n        <option value=\"\">Seleziona un Veicolo</option>\r\n        {vehicles.map(v => (\r\n          <option key={v.id} value={v.id}>\r\n            {v.brand} {v.model} ({v.license_plate}) - {v.category_name}\r\n          </option>\r\n        ))}\r\n      </select>\r\n      {formData.vehicle_id && vehicles.find(v => v.id === parseInt(formData.vehicle_id)) && (\r\n        <div style={{ marginTop: '20px', padding: '15px', border: '1px solid #ccc', borderRadius: '4px' }}>\r\n          <h4>Dettagli Veicolo</h4>\r\n          <p><strong>Targa:</strong> {vehicles.find(v => v.id === parseInt(formData.vehicle_id)).license_plate}</p>\r\n          <p><strong>Categoria:</strong> {vehicles.find(v => v.id === parseInt(formData.vehicle_id)).category_name}</p>\r\n          <p><strong>Km Attuali:</strong> {vehicles.find(v => v.id === parseInt(formData.vehicle_id)).current_km} km</p>\r\n          <p><strong>Tariffa Base:</strong> {vehicles.find(v => v.id === parseInt(formData.vehicle_id)).daily_rate} €/giorno</p>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  const renderStep3 = () => (\r\n    <div>\r\n      <h3 style={{ marginBottom: '24px' }}>Dettagli Ritiro e Riconsegna</h3>\r\n      \r\n      <div className=\"form-group\">\r\n        <label>Data/Ora Ritiro Effettivo</label>\r\n        <input \r\n          type=\"datetime-local\" \r\n          name=\"pickup_date\" \r\n          value={formData.pickup_date} \r\n          onChange={handleChange} \r\n          className=\"form-control\"\r\n          required\r\n        />\r\n      </div>\r\n\r\n      <div className=\"form-group\">\r\n        <label>Data/Ora Riconsegna Prevista</label>\r\n        <input \r\n          type=\"datetime-local\" \r\n          name=\"expected_return_date\" \r\n          value={formData.expected_return_date} \r\n          onChange={handleChange} \r\n          className=\"form-control\"\r\n          required\r\n        />\r\n      </div>\r\n\r\n      <div className=\"form-group\">\r\n        <label>Luogo di Ritiro</label>\r\n        <input \r\n          type=\"text\" \r\n          name=\"pickup_location\" \r\n          value={formData.pickup_location} \r\n          onChange={handleChange} \r\n          className=\"form-control\"\r\n        />\r\n      </div>\r\n\r\n      <div className=\"form-group\">\r\n        <label>Livello Carburante al Ritiro (%)</label>\r\n        <input \r\n          type=\"number\" \r\n          name=\"pickup_fuel_level\" \r\n          value={formData.pickup_fuel_level} \r\n          onChange={handleChange} \r\n          className=\"form-control\"\r\n          min=\"0\"\r\n          max=\"100\"\r\n        />\r\n      </div>\r\n\r\n      <div className=\"form-group\">\r\n        <label>Km al Ritiro (OBBLIGATORIO)</label>\r\n        <input \r\n          type=\"number\" \r\n          name=\"pickup_km\" \r\n          value={formData.pickup_km} \r\n          onChange={handleChange} \r\n          className=\"form-control\"\r\n          required\r\n        />\r\n      </div>\r\n\r\n      <div className=\"form-group\">\r\n        <label>Danni Visibili al Ritiro</label>\r\n        <textarea \r\n          name=\"pickup_damages\" \r\n          value={formData.pickup_damages} \r\n          onChange={handleChange} \r\n          className=\"form-control\"\r\n        />\r\n      </div>\r\n      \r\n      <div className=\"form-group\">\r\n        <label>Note di Ritiro</label>\r\n        <textarea \r\n          name=\"pickup_notes\" \r\n          value={formData.pickup_notes} \r\n          onChange={handleChange} \r\n          className=\"form-control\"\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n  \r\n  const renderStep4 = () => (\r\n    <div>\r\n      <h3 style={{ marginBottom: '24px' }}>Conducente Aggiuntivo (Opzionale)</h3>\r\n      <div className=\"form-group\">\r\n        <label>Nome Completo</label>\r\n        <input type=\"text\" name=\"additional_driver_name\" value={formData.additional_driver_name} onChange={handleChange} className=\"form-control\" />\r\n      </div>\r\n      <div className=\"form-group\">\r\n        <label>Luogo di Nascita</label>\r\n        <input type=\"text\" name=\"additional_driver_birth_place\" value={formData.additional_driver_birth_place} onChange={handleChange} className=\"form-control\" />\r\n      </div>\r\n      <div className=\"form-group\">\r\n        <label>Data di Nascita</label>\r\n        <input type=\"date\" name=\"additional_driver_birth_date\" value={formData.additional_driver_birth_date} onChange={handleChange} className=\"form-control\" />\r\n      </div>\r\n      <div className=\"form-group\">\r\n        <label>Numero Patente</label>\r\n        <input type=\"text\" name=\"additional_driver_license\" value={formData.additional_driver_license} onChange={handleChange} className=\"form-control\" />\r\n      </div>\r\n      <div className=\"form-group\">\r\n        <label>Rilasciata da</label>\r\n        <input type=\"text\" name=\"additional_driver_license_issued_by\" value={formData.additional_driver_license_issued_by} onChange={handleChange} className=\"form-control\" />\r\n      </div>\r\n      <div className=\"form-group\">\r\n        <label>Data Rilascio Patente</label>\r\n        <input type=\"date\" name=\"additional_driver_license_issue_date\" value={formData.additional_driver_license_issue_date} onChange={handleChange} className=\"form-control\" />\r\n      </div>\r\n      <div className=\"form-group\">\r\n        <label>Data Scadenza Patente</label>\r\n        <input type=\"date\" name=\"additional_driver_license_expiry\" value={formData.additional_driver_license_expiry} onChange={handleChange} className=\"form-control\" />\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const renderStep5 = () => (\r\n    <div>\r\n      <h3 style={{ marginBottom: '24px' }}>Tariffe e Costi Base</h3>\r\n      \r\n      <div className=\"form-group\">\r\n        <label>Tariffa Giornaliera (€)</label>\r\n        <input type=\"number\" name=\"daily_rate\" value={formData.daily_rate} onChange={handleChange} className=\"form-control\" />\r\n      </div>\r\n      <div className=\"form-group\">\r\n        <label>Giorni di Noleggio (Totali)</label>\r\n        <input type=\"number\" name=\"total_days\" value={formData.total_days} onChange={handleChange} className=\"form-control\" />\r\n      </div>\r\n      <div className=\"form-group\">\r\n        <label>Cauzione (€)</label>\r\n        <input type=\"number\" name=\"deposit_amount\" value={formData.deposit_amount} onChange={handleChange} className=\"form-control\" />\r\n      </div>\r\n      <div className=\"form-group\">\r\n        <label>Km Inclusi (es. Illimitati o 100km/giorno)</label>\r\n        <input type=\"text\" name=\"km_included\" value={formData.km_included} onChange={handleChange} className=\"form-control\" />\r\n      </div>\r\n\r\n      <h4 style={{ marginTop: '30px' }}>Costi Aggiuntivi Preimpostati</h4>\r\n      \r\n      <div className=\"form-group\">\r\n        <label>Costo Carburante (a litro - default: **2.50** €)</label>\r\n        <input type=\"number\" name=\"fuel_charge\" value={formData.fuel_charge} onChange={handleChange} className=\"form-control\" />\r\n      </div>\r\n      \r\n      <div className=\"form-group\">\r\n        <label>Addebito Fuori Orario (default: **20.00** €)</label>\r\n        <input type=\"number\" name=\"after_hours_charge\" value={formData.after_hours_charge} onChange={handleChange} className=\"form-control\" />\r\n      </div>\r\n      \r\n      <div className=\"form-group\">\r\n        <label>Costo KM Extra (a km - default: **0.56** €)</label>\r\n        <input type=\"number\" name=\"km_extra_cost\" value={formData.km_extra_cost} onChange={handleChange} className=\"form-control\" />\r\n      </div>\r\n      \r\n      <div className=\"form-group\">\r\n        <label>Costo Consegna/Ritiro (€)</label>\r\n        <input type=\"number\" name=\"delivery_cost\" value={formData.delivery_cost} onChange={handleChange} className=\"form-control\" />\r\n      </div>\r\n      \r\n      <div className=\"form-group\">\r\n        <label>Costi Extra Generici (es. Seggiolino, Navigatore)</label>\r\n        <input type=\"number\" name=\"extras_charge\" value={formData.extras_charge} onChange={handleChange} className=\"form-control\" />\r\n      </div>\r\n\r\n    </div>\r\n  );\r\n\r\n  const renderStep6 = () => (\r\n    <div>\r\n      <h3 style={{ marginBottom: '24px' }}>Riepilogo Costi e Totali</h3>\r\n      \r\n      {/* Questi campi sono teoricamente calcolati, ma permettiamo la modifica manuale */}\r\n      <div className=\"form-group\">\r\n        <label>Addebito KM Extra Totale (€)</label>\r\n        <input type=\"number\" name=\"extra_km_charge\" value={formData.extra_km_charge} onChange={handleChange} className=\"form-control\" />\r\n      </div>\r\n      \r\n      <div className=\"form-group\">\r\n        <label>Addebito Coperture Aggiuntive Totale (€)</label>\r\n        <input type=\"number\" name=\"franchise_charge\" value={formData.franchise_charge} onChange={handleChange} className=\"form-control\" />\r\n      </div>\r\n      \r\n      <div className=\"form-group\">\r\n        <label>Sconto Applicato (€)</label>\r\n        <input type=\"number\" name=\"discount\" value={formData.discount} onChange={handleChange} className=\"form-control\" />\r\n      </div>\r\n\r\n      <div style={{ marginTop: '30px', padding: '15px', border: '1px solid #007bff', borderRadius: '4px', background: '#e9f5ff' }}>\r\n        <h4>Totali (Calcolati o Inseriti Manualmente)</h4>\r\n        <div className=\"form-group\">\r\n          <label>Subtotale Noleggio (€)</label>\r\n          <input type=\"number\" name=\"subtotal\" value={formData.subtotal} onChange={handleChange} className=\"form-control\" />\r\n        </div>\r\n        <div className=\"form-group\">\r\n          <label>Totale Contratto (€)</label>\r\n          <input type=\"number\" name=\"total_amount\" value={formData.total_amount} onChange={handleChange} className=\"form-control\" />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const renderStep7 = () => (\r\n    <div>\r\n      <h3 style={{ marginBottom: '24px' }}>Coperture Assicurative (Franchigie)</h3>\r\n      <p style={{ fontSize: '14px', color: '#6c757d' }}>\r\n        Valori franchigie in caso di sinistro/furto/incendio.\r\n      </p>\r\n      \r\n      <div className=\"form-group\">\r\n        <label>Franchigia Furto/Incendio (€)</label>\r\n        <input type=\"number\" name=\"franchise_theft\" value={formData.franchise_theft} onChange={handleChange} className=\"form-control\" />\r\n      </div>\r\n      \r\n      <div className=\"form-group\">\r\n        <label>Franchigia Danni (€)</label>\r\n        <input type=\"number\" name=\"franchise_damage\" value={formData.franchise_damage} onChange={handleChange} className=\"form-control\" />\r\n      </div>\r\n      \r\n      <div className=\"form-group\">\r\n        <label>Massimale RCA (€)</label>\r\n        <input type=\"number\" name=\"franchise_rca\" value={formData.franchise_rca} onChange={handleChange} className=\"form-control\" />\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const renderStep8 = () => (\r\n    <div>\r\n      <h3 style={{ marginBottom: '24px' }}>Dettagli Pagamento</h3>\r\n      \r\n      <div className=\"form-group\">\r\n        <label>Metodo Pagamento Totale</label>\r\n        <select name=\"payment_method\" value={formData.payment_method} onChange={handleChange} className=\"form-control\">\r\n          <option value=\"Contanti\">Contanti</option>\r\n          <option value=\"Carta di Credito\">Carta di Credito</option>\r\n          <option value=\"Bonifico\">Bonifico</option>\r\n        </select>\r\n      </div>\r\n\r\n      <div className=\"form-group\">\r\n        <label>Metodo Pagamento Cauzione</label>\r\n        <select name=\"deposit_method\" value={formData.deposit_method} onChange={handleChange} className=\"form-control\">\r\n          <option value=\"Contanti\">Contanti</option>\r\n          <option value=\"Carta di Credito\">Carta di Credito</option>\r\n          <option value=\"Assegno\">Assegno</option>\r\n        </select>\r\n      </div>\r\n      \r\n      <h4 style={{ marginTop: '30px' }}>Dati Carta di Credito (Se usata)</h4>\r\n      \r\n      <div className=\"form-group\">\r\n        <label>Nome Intestatario CC</label>\r\n        <input type=\"text\" name=\"cc_holder_name\" value={formData.cc_holder_name} onChange={handleChange} className=\"form-control\" />\r\n      </div>\r\n      \r\n      <div className=\"form-group\">\r\n        <label>Tipo Carta</label>\r\n        <select name=\"cc_type\" value={formData.cc_type} onChange={handleChange} className=\"form-control\">\r\n          <option value=\"VISA\">VISA</option>\r\n          <option value=\"MasterCard\">MasterCard</option>\r\n          <option value=\"AMEX\">AMEX</option>\r\n          <option value=\"Diners\">Diners</option>\r\n        </select>\r\n      </div>\r\n      \r\n      <div className=\"form-group\">\r\n        <label>Numero Carta (Masked)</label>\r\n        <input type=\"text\" name=\"cc_number_masked\" value={formData.cc_number_masked} onChange={handleChange} className=\"form-control\" placeholder=\"**** **** **** 1234\" />\r\n      </div>\r\n      \r\n      <div className=\"form-group\">\r\n        <label>Scadenza (MM/AA)</label>\r\n        <input type=\"text\" name=\"cc_expiry\" value={formData.cc_expiry} onChange={handleChange} className=\"form-control\" placeholder=\"05/26\" />\r\n      </div>\r\n\r\n    </div>\r\n  );\r\n\r\n  const renderStep9 = () => (\r\n    <div>\r\n      <h3 style={{ marginBottom: '24px' }}>Riepilogo Finale del Contratto</h3>\r\n      \r\n      <div style={{ padding: '20px', border: '1px solid #007bff', borderRadius: '8px', background: '#f8f9fa' }}>\r\n        <h4>Informazioni Essenziali</h4>\r\n        <p><strong>Cliente:</strong> {customers.find(c => c.id === parseInt(formData.customer_id))?.full_name}</p>\r\n        <p><strong>Veicolo:</strong> {vehicles.find(v => v.id === parseInt(formData.vehicle_id))?.brand} {vehicles.find(v => v.id === parseInt(formData.vehicle_id))?.model} ({vehicles.find(v => v.id === parseInt(formData.vehicle_id))?.license_plate})</p>\r\n        <p><strong>Ritiro:</strong> {new Date(formData.pickup_date).toLocaleString()}</p>\r\n        <p><strong>Riconsegna Prevista:</strong> {new Date(formData.expected_return_date).toLocaleString()}</p>\r\n        <p><strong>Totale Contratto:</strong> **{parseFloat(formData.total_amount).toFixed(2)} €**</p>\r\n        <p><strong>Cauzione:</strong> {parseFloat(formData.deposit_amount).toFixed(2)} €</p>\r\n        \r\n        <h5 style={{ marginTop: '15px' }}>Dettagli Costi Extra:</h5>\r\n        <ul>\r\n          <li>**Carburante a Litro:** {formData.fuel_charge} €</li>\r\n          <li>**Addebito Fuori Orario:** {formData.after_hours_charge} €</li>\r\n          <li>**Costo KM Extra (unitario):** {formData.km_extra_cost} €/km</li>\r\n          <li>**Totale Extra:** {(parseFloat(formData.delivery_cost) + parseFloat(formData.extras_charge)).toFixed(2)} €</li>\r\n        </ul>\r\n      </div>\r\n      \r\n      <p style={{ marginTop: '20px', color: '#dc3545' }}>\r\n        **AVVISO:** La pressione del tasto \"Crea Noleggio\" finalizzerà il contratto e lo renderà attivo.\r\n      </p>\r\n    </div>\r\n  );\r\n\r\n  // ✅ STEP 10: CONSENSI E FIRMA (AGGIUNTO SIGNATURE PAD)\r\n  const renderStep10 = () => (\r\n    <div>\r\n      <h3 style={{ marginBottom: '24px' }}>Consensi e Firma Contratto</h3>\r\n      \r\n      <div style={{ marginBottom: '30px' }}>\r\n        <h4>Firma del Cliente</h4>\r\n        <p style={{ fontSize: '14px', color: '#6c757d' }}>\r\n          Apponi la firma con il tuo dito o stilo sul dispositivo mobile.\r\n        </p>\r\n        \r\n        <div style={{ \r\n          border: '1px solid #ccc', \r\n          borderRadius: '4px', \r\n          maxWidth: '400px', \r\n          margin: '0 auto',\r\n          background: '#fff'\r\n        }}>\r\n          {/* Componente SignaturePad effettivo */}\r\n          <SignaturePad \r\n            ref={sigCanvas} \r\n            penColor='black' \r\n            canvasProps={{ \r\n              width: 400, // Larghezza fissa\r\n              height: 200, // Altezza fissa\r\n              className: 'sigCanvas',\r\n              style: { \r\n                border: '1px solid transparent', \r\n                borderRadius: '4px',\r\n                touchAction: 'none' // Essenziale per un buon supporto touch\r\n              } \r\n            }}\r\n            onEnd={handleSignatureEnd}\r\n          />\r\n        </div>\r\n        \r\n        <div style={{ display: 'flex', justifyContent: 'center', marginTop: '10px', gap: '10px' }}>\r\n          <button \r\n            type=\"button\" \r\n            onClick={handleSignatureClear} \r\n            className=\"btn btn-sm btn-outline-danger\"\r\n          >\r\n            Cancella Firma\r\n          </button>\r\n          {formData.customer_signature && (\r\n            <span style={{ color: '#1a4d2e', fontSize: '14px', lineHeight: '30px' }}>\r\n              ✅ Firma acquisita\r\n            </span>\r\n          )}\r\n        </div>\r\n        \r\n        {!formData.customer_signature && (\r\n            <p style={{ color: '#dc3545', textAlign: 'center', marginTop: '10px' }}>\r\n                *Firma obbligatoria per procedere.\r\n            </p>\r\n        )}\r\n      </div>\r\n\r\n      <h4>Dichiarazioni e Consensi</h4>\r\n      <div className=\"form-group form-check\">\r\n        <input \r\n          type=\"checkbox\" \r\n          id=\"contract_signed\"\r\n          name=\"contract_signed\" \r\n          checked={formData.contract_signed} \r\n          onChange={handleChange} \r\n          className=\"form-check-input\"\r\n        />\r\n        <label className=\"form-check-label\" htmlFor=\"contract_signed\">\r\n          Dichiaro di aver letto e accettato integralmente il contratto di noleggio e le condizioni generali.\r\n        </label>\r\n      </div>\r\n\r\n      <div className=\"form-group form-check\">\r\n        <input \r\n          type=\"checkbox\" \r\n          id=\"privacy_consent\"\r\n          name=\"privacy_consent\" \r\n          checked={formData.privacy_consent} \r\n          onChange={handleChange} \r\n          className=\"form-check-input\"\r\n        />\r\n        <label className=\"form-check-label\" htmlFor=\"privacy_consent\">\r\n          Acconsento al trattamento dei dati personali (OBBLIGATORIO).\r\n        </label>\r\n      </div>\r\n      \r\n      <div className=\"form-group form-check\">\r\n        <input \r\n          type=\"checkbox\" \r\n          id=\"marketing_consent\"\r\n          name=\"marketing_consent\" \r\n          checked={formData.marketing_consent} \r\n          onChange={handleChange} \r\n          className=\"form-check-input\"\r\n        />\r\n        <label className=\"form-check-label\" htmlFor=\"marketing_consent\">\r\n          Acconsento a ricevere comunicazioni promozionali e di marketing.\r\n        </label>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const renderStep11 = () => (\r\n    <div>\r\n      <h3 style={{ marginBottom: '24px' }}>Foto Iniziali del Veicolo</h3>\r\n      \r\n      {formData.rental_id ? (\r\n        <PhotoUpload\r\n          rentalId={formData.rental_id}\r\n          photoType=\"pickup\"\r\n          // Funzione per aggiornare la lista delle foto, se necessario\r\n          onPhotosChange={(photos) => console.log('Pickup photos updated:', photos)}\r\n        />\r\n      ) : (\r\n        <div className=\"alert alert-warning\">\r\n          Noleggio non ancora creato. Torna indietro e premi \"Crea Noleggio\".\r\n        </div>\r\n      )}\r\n      \r\n      <p style={{ marginTop: '20px', color: '#6c757d' }}>\r\n        Carica qui le foto che documentano lo stato del veicolo al momento del ritiro.\r\n      </p>\r\n    </div>\r\n  );\r\n\r\n\r\n  const renderStepContent = () => {\r\n    switch (currentStep) {\r\n      case 1: return renderStep1();\r\n      case 2: return renderStep2();\r\n      case 3: return renderStep3();\r\n      case 4: return renderStep4();\r\n      case 5: return renderStep5();\r\n      case 6: return renderStep6();\r\n      case 7: return renderStep7();\r\n      case 8: return renderStep8();\r\n      case 9: return renderStep9();\r\n      case 10: return renderStep10();\r\n      case 11: return renderStep11();\r\n      default: return <div>Step non trovato</div>;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"container\" style={{ paddingTop: '30px' }}>\r\n      <div className=\"row justify-content-center\">\r\n        <div className=\"col-lg-10\">\r\n          <div className=\"card shadow-sm\">\r\n            <div className=\"card-header bg-primary text-white\">\r\n              <h2 className=\"mb-0\">Nuovo Contratto di Noleggio</h2>\r\n            </div>\r\n            \r\n            <div className=\"card-body\">\r\n              {/* Stepper progress bar */}\r\n              <div style={{ \r\n                display: 'flex', \r\n                justifyContent: 'space-between', \r\n                marginBottom: '30px',\r\n                overflowX: 'auto',\r\n                paddingBottom: '10px'\r\n              }}>\r\n                {steps.map(step => (\r\n                  <div \r\n                    key={step.num} \r\n                    style={{ \r\n                      textAlign: 'center', \r\n                      minWidth: '100px',\r\n                      cursor: 'pointer',\r\n                      opacity: currentStep === step.num ? 1 : 0.6,\r\n                      borderBottom: currentStep === step.num ? '3px solid #007bff' : '3px solid transparent',\r\n                      paddingBottom: '5px'\r\n                    }}\r\n                    onClick={() => setCurrentStep(step.num)}\r\n                  >\r\n                    <div style={{ \r\n                      display: 'inline-flex', \r\n                      alignItems: 'center', \r\n                      justifyContent: 'center', \r\n                      width: '30px', \r\n                      height: '30px', \r\n                      borderRadius: '50%', \r\n                      background: currentStep >= step.num ? '#007bff' : '#ccc', \r\n                      color: 'white',\r\n                      marginBottom: '5px'\r\n                    }}>\r\n                      {step.icon}\r\n                    </div>\r\n                    <div style={{ fontSize: '12px', fontWeight: 'bold', color: currentStep >= step.num ? '#007bff' : '#6c757d' }}>\r\n                      {step.name}\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n              \r\n              {/* Contenuto dello step */}\r\n              <div style={{ minHeight: '400px', padding: '20px', border: '1px solid #eee', borderRadius: '4px' }}>\r\n                {renderStepContent()}\r\n              </div>\r\n\r\n            </div>\r\n            \r\n            <div \r\n              className=\"card-footer\" \r\n              style={{ \r\n                display: 'flex', \r\n                justifyContent: 'space-between', \r\n                padding: '15px 20px', \r\n                backgroundColor: '#f8f9fa' \r\n              }}\r\n            >\r\n              {currentStep > 1 && currentStep < 11 && (\r\n                <button\r\n                  onClick={handlePrevious}\r\n                  className=\"btn btn-secondary\"\r\n                >\r\n                  <ArrowLeft size={18} />\r\n                  Indietro\r\n                </button>\r\n              )}\r\n              \r\n              {currentStep < 10 && (\r\n                <button\r\n                  onClick={handleNext}\r\n                  className=\"btn btn-primary\"\r\n                  style={{ marginLeft: currentStep > 1 ? '' : 'auto' }}\r\n                >\r\n                  Avanti\r\n                  <ArrowRight size={18} />\r\n                </button>\r\n              )}\r\n              \r\n              {currentStep === 10 && (\r\n                <button\r\n                  onClick={handleSubmit}\r\n                  className=\"btn btn-success\"\r\n                  disabled={loading || !formData.contract_signed || !formData.privacy_consent || !formData.customer_signature} \r\n                  style={{ marginLeft: currentStep > 1 ? 'auto' : 'auto' }}\r\n                >\r\n                  {loading ? 'Creazione...' : (\r\n                    <>\r\n                      <Save size={18} />\r\n                      Crea Noleggio\r\n                    </>\r\n                  )}\r\n                </button>\r\n              )}\r\n              \r\n              {currentStep === 11 && (\r\n                <button\r\n                  onClick={handleFinish}\r\n                  className=\"btn btn-success\"\r\n                  style={{ marginLeft: 'auto' }}\r\n                >\r\n                  <CheckCircle size={18} />\r\n                  Completa\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NewRental;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}