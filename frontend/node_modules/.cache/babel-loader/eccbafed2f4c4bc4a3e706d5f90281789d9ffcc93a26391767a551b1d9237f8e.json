{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link}from'react-router-dom';import{usersAPI}from'../services/api';// Dovrai implementare usersAPI\nimport{useAuth}from'../contexts/AuthContext';import toast from'react-hot-toast';import{Users,Plus,Trash2,Shield}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const UsersList=()=>{const{user}=useAuth();const[users,setUsers]=useState([]);const[loading,setLoading]=useState(true);useEffect(()=>{if((user===null||user===void 0?void 0:user.role)==='admin'){loadUsers();}},[user]);const loadUsers=async()=>{try{setLoading(true);// Assumiamo che usersAPI esista e chiami GET /api/users (Admin Only)\nconst response=await usersAPI.getAll();setUsers(response.data.data);}catch(error){console.error('Errore caricamento utenti:',error);toast.error('Errore nel caricamento degli utenti. Verifica i permessi.');}finally{setLoading(false);}};const handleDelete=async(userId,userName)=>{if(!window.confirm(\"Sei sicuro di voler eliminare l'utente \".concat(userName,\"?\"))){return;}try{await usersAPI.remove(userId);// Assumiamo DELETE /api/users/:id\ntoast.success(\"Utente \".concat(userName,\" eliminato con successo.\"));loadUsers();}catch(error){var _error$response,_error$response$data;console.error('Errore eliminazione utente:',error);toast.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Errore durante l\\'eliminazione.');}};if(loading){return/*#__PURE__*/_jsx(\"p\",{children:\"Caricamento utenti...\"});}if((user===null||user===void 0?void 0:user.role)!=='admin'){return/*#__PURE__*/_jsx(\"div\",{className:\"content-area\",children:/*#__PURE__*/_jsx(\"p\",{className:\"alert alert-danger\",children:\"Accesso negato. Solo gli amministratori possono visualizzare questa sezione.\"})});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"top-bar\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Gestione Utenti\"}),/*#__PURE__*/_jsxs(Link,{to:\"/users/new\",className:\"btn btn-primary\",children:[/*#__PURE__*/_jsx(Plus,{size:18}),\"Nuovo Utente\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"content-area\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-header\",children:[/*#__PURE__*/_jsx(Users,{size:18,style:{marginRight:'8px'}}),\"Lista Utenti (\",users.length,\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:users.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"Nessun utente trovato.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"table-container\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Nome Completo\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Username\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Ruolo\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Azioni\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:users.map(u=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{style:{fontWeight:'600'},children:u.full_name}),/*#__PURE__*/_jsx(\"td\",{children:u.username}),/*#__PURE__*/_jsx(\"td\",{children:u.email}),/*#__PURE__*/_jsx(\"td\",{children:u.role==='admin'?/*#__PURE__*/_jsx(\"span\",{className:\"badge badge-danger\",children:\"Amministratore\"}):/*#__PURE__*/_jsx(\"span\",{className:\"badge badge-info\",children:\"Operatore\"})}),/*#__PURE__*/_jsx(\"td\",{children:u.id!==user.id&&/*#__PURE__*/// Non permettere di auto-eliminarsi\n_jsx(\"button\",{onClick:()=>handleDelete(u.id,u.full_name),className:\"btn btn-sm btn-outline-danger\",title:\"Elimina Utente\",children:/*#__PURE__*/_jsx(Trash2,{size:16})})})]},u.id))})]})})})]})})]});};export default UsersList;","map":{"version":3,"names":["React","useState","useEffect","Link","usersAPI","useAuth","toast","Users","Plus","Trash2","Shield","jsx","_jsx","jsxs","_jsxs","UsersList","user","users","setUsers","loading","setLoading","role","loadUsers","response","getAll","data","error","console","handleDelete","userId","userName","window","confirm","concat","remove","success","_error$response","_error$response$data","message","children","className","to","size","style","marginRight","length","map","u","fontWeight","full_name","username","email","id","onClick","title"],"sources":["D:/Bncrentcar/frontend/src/components/UsersList.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { usersAPI } from '../services/api'; // Dovrai implementare usersAPI\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport toast from 'react-hot-toast';\r\nimport { Users, Plus, Trash2, Shield } from 'lucide-react';\r\n\r\nconst UsersList = () => {\r\n  const { user } = useAuth();\r\n  const [users, setUsers] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    if (user?.role === 'admin') {\r\n        loadUsers();\r\n    }\r\n  }, [user]);\r\n\r\n  const loadUsers = async () => {\r\n    try {\r\n      setLoading(true);\r\n      // Assumiamo che usersAPI esista e chiami GET /api/users (Admin Only)\r\n      const response = await usersAPI.getAll(); \r\n      setUsers(response.data.data);\r\n    } catch (error) {\r\n      console.error('Errore caricamento utenti:', error);\r\n      toast.error('Errore nel caricamento degli utenti. Verifica i permessi.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (userId, userName) => {\r\n    if (!window.confirm(`Sei sicuro di voler eliminare l'utente ${userName}?`)) {\r\n        return;\r\n    }\r\n    try {\r\n        await usersAPI.remove(userId); // Assumiamo DELETE /api/users/:id\r\n        toast.success(`Utente ${userName} eliminato con successo.`);\r\n        loadUsers();\r\n    } catch (error) {\r\n        console.error('Errore eliminazione utente:', error);\r\n        toast.error(error.response?.data?.message || 'Errore durante l\\'eliminazione.');\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return <p>Caricamento utenti...</p>;\r\n  }\r\n\r\n  if (user?.role !== 'admin') {\r\n    return (\r\n        <div className=\"content-area\">\r\n            <p className=\"alert alert-danger\">Accesso negato. Solo gli amministratori possono visualizzare questa sezione.</p>\r\n        </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"top-bar\">\r\n        <h1>Gestione Utenti</h1>\r\n        <Link to=\"/users/new\" className=\"btn btn-primary\">\r\n          <Plus size={18} />\r\n          Nuovo Utente\r\n        </Link>\r\n      </div>\r\n\r\n      <div className=\"content-area\">\r\n        <div className=\"card\">\r\n          <div className=\"card-header\">\r\n            <Users size={18} style={{ marginRight: '8px' }} />\r\n            Lista Utenti ({users.length})\r\n          </div>\r\n          <div className=\"card-body\">\r\n            {users.length === 0 ? (\r\n              <p>Nessun utente trovato.</p>\r\n            ) : (\r\n              <div className=\"table-container\">\r\n                <table className=\"table\">\r\n                  <thead>\r\n                    <tr>\r\n                      <th>Nome Completo</th>\r\n                      <th>Username</th>\r\n                      <th>Email</th>\r\n                      <th>Ruolo</th>\r\n                      <th>Azioni</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {users.map((u) => (\r\n                      <tr key={u.id}>\r\n                        <td style={{ fontWeight: '600' }}>{u.full_name}</td>\r\n                        <td>{u.username}</td>\r\n                        <td>{u.email}</td>\r\n                        <td>\r\n                            {u.role === 'admin' \r\n                                ? <span className=\"badge badge-danger\">Amministratore</span> \r\n                                : <span className=\"badge badge-info\">Operatore</span>\r\n                            }\r\n                        </td>\r\n                        <td>\r\n                          {u.id !== user.id && ( // Non permettere di auto-eliminarsi\r\n                            <button\r\n                                onClick={() => handleDelete(u.id, u.full_name)}\r\n                                className=\"btn btn-sm btn-outline-danger\"\r\n                                title=\"Elimina Utente\"\r\n                            >\r\n                                <Trash2 size={16} />\r\n                            </button>\r\n                          )}\r\n                        </td>\r\n                      </tr>\r\n                    ))}\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UsersList;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}