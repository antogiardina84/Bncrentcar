{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link}from'react-router-dom';import{customersAPI}from'../services/api';import toast from'react-hot-toast';import{Users,Plus,Search}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CustomersList=()=>{const[customers,setCustomers]=useState([]);const[loading,setLoading]=useState(true);const[searchTerm,setSearchTerm]=useState('');useEffect(()=>{loadCustomers();},[]);const loadCustomers=async()=>{try{setLoading(true);const response=await customersAPI.getAll({search:searchTerm});// Correzione 1: Assicura che i dati impostati siano un array\n// L'API ritorna { success: true, data: [clienti...] }, quindi usiamo response.data.data\nconst customerData=response.data.data;setCustomers(Array.isArray(customerData)?customerData:[]);}catch(error){console.error('Errore caricamento clienti:',error);toast.error('Errore nel caricamento dei clienti');setCustomers([]);// Assicurati che lo stato sia un array anche in caso di errore\n}finally{setLoading(false);}};const handleSearch=e=>{e.preventDefault();loadCustomers();};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"top-bar\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Gestione Clienti\"}),/*#__PURE__*/_jsxs(Link,{to:\"/customers/new\",className:\"btn btn-primary\",children:[/*#__PURE__*/_jsx(Plus,{size:18}),\"Nuovo Cliente\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"content-area\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-header\",children:[/*#__PURE__*/_jsx(Users,{size:20}),\"Lista Clienti\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSearch,className:\"search-form\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",style:{flexGrow:1},children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-group\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text\",children:/*#__PURE__*/_jsx(Search,{size:18})}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",placeholder:\"Cerca per nome, codice fiscale, telefono o email...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value)})]})}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",children:\"Cerca\"})]}),loading?/*#__PURE__*/_jsx(\"p\",{children:\"Caricamento...\"}):// Correzione 2: Aggiungi un fallback array vuoto per evitare l'errore \"not a function\"\ncustomers&&customers.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"table-container\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Nome\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Codice Fiscale\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Telefono\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Citt\\xE0\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Azioni\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:(customers||[]).map(customer=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{style:{fontWeight:'600'},children:customer.full_name}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"code\",{children:customer.fiscal_code})}),/*#__PURE__*/_jsx(\"td\",{children:customer.phone}),/*#__PURE__*/_jsx(\"td\",{children:customer.email}),/*#__PURE__*/_jsx(\"td\",{children:customer.city}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Link,{to:\"/customers/\".concat(customer.id),className:\"btn btn-sm btn-outline-primary\",children:\"Dettagli\"})})]},customer.id))})]})}):/*#__PURE__*/_jsx(\"p\",{className:\"text-muted text-center\",style:{marginTop:'20px'},children:\"Nessun cliente trovato.\"})]})]})})]});};export default CustomersList;","map":{"version":3,"names":["React","useState","useEffect","Link","customersAPI","toast","Users","Plus","Search","jsx","_jsx","jsxs","_jsxs","CustomersList","customers","setCustomers","loading","setLoading","searchTerm","setSearchTerm","loadCustomers","response","getAll","search","customerData","data","Array","isArray","error","console","handleSearch","e","preventDefault","children","className","to","size","onSubmit","style","flexGrow","type","placeholder","value","onChange","target","length","map","customer","fontWeight","full_name","fiscal_code","phone","email","city","concat","id","marginTop"],"sources":["D:/Bncrentcar/frontend/src/components/CustomersList.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { customersAPI } from '../services/api';\r\nimport toast from 'react-hot-toast';\r\nimport { Users, Plus, Search } from 'lucide-react';\r\n\r\nconst CustomersList = () => {\r\n  const [customers, setCustomers] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n\r\n  useEffect(() => {\r\n    loadCustomers();\r\n  }, []);\r\n\r\n  const loadCustomers = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await customersAPI.getAll({ search: searchTerm });\r\n      \r\n      // Correzione 1: Assicura che i dati impostati siano un array\r\n      // L'API ritorna { success: true, data: [clienti...] }, quindi usiamo response.data.data\r\n      const customerData = response.data.data;\r\n      setCustomers(Array.isArray(customerData) ? customerData : []);\r\n\r\n    } catch (error) {\r\n      console.error('Errore caricamento clienti:', error);\r\n      toast.error('Errore nel caricamento dei clienti');\r\n      setCustomers([]); // Assicurati che lo stato sia un array anche in caso di errore\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSearch = (e) => {\r\n    e.preventDefault();\r\n    loadCustomers();\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"top-bar\">\r\n        <h1>Gestione Clienti</h1>\r\n        <Link to=\"/customers/new\" className=\"btn btn-primary\">\r\n          <Plus size={18} />\r\n          Nuovo Cliente\r\n        </Link>\r\n      </div>\r\n\r\n      <div className=\"content-area\">\r\n        <div className=\"card\">\r\n          <div className=\"card-header\">\r\n            <Users size={20} />\r\n            Lista Clienti\r\n          </div>\r\n          <div className=\"card-body\">\r\n            <form onSubmit={handleSearch} className=\"search-form\">\r\n              <div className=\"form-group\" style={{ flexGrow: 1 }}>\r\n                <div className=\"input-group\">\r\n                  <span className=\"input-group-text\">\r\n                    <Search size={18} />\r\n                  </span>\r\n                  <input\r\n                    type=\"text\"\r\n                    className=\"form-control\"\r\n                    placeholder=\"Cerca per nome, codice fiscale, telefono o email...\"\r\n                    value={searchTerm}\r\n                    onChange={(e) => setSearchTerm(e.target.value)}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <button type=\"submit\" className=\"btn btn-primary\">\r\n                Cerca\r\n              </button>\r\n            </form>\r\n\r\n            {loading ? (\r\n              <p>Caricamento...</p>\r\n            ) : (\r\n              // Correzione 2: Aggiungi un fallback array vuoto per evitare l'errore \"not a function\"\r\n              (customers && customers.length > 0) ? (\r\n                <div className=\"table-container\">\r\n                  <table className=\"table\">\r\n                    <thead>\r\n                      <tr>\r\n                        <th>Nome</th>\r\n                        <th>Codice Fiscale</th>\r\n                        <th>Telefono</th>\r\n                        <th>Email</th>\r\n                        <th>Città</th>\r\n                        <th>Azioni</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      {/* Correzione diretta per prevenire il crash se customers non è un array */}\r\n                      {(customers || []).map((customer) => (\r\n                        <tr key={customer.id}>\r\n                          <td style={{ fontWeight: '600' }}>{customer.full_name}</td>\r\n                          <td><code>{customer.fiscal_code}</code></td>\r\n                          <td>{customer.phone}</td>\r\n                          <td>{customer.email}</td>\r\n                          <td>{customer.city}</td>\r\n                          <td>\r\n                            <Link\r\n                              to={`/customers/${customer.id}`}\r\n                              className=\"btn btn-sm btn-outline-primary\"\r\n                            >\r\n                              Dettagli\r\n                            </Link>\r\n                          </td>\r\n                        </tr>\r\n                      ))}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              ) : (\r\n                <p className=\"text-muted text-center\" style={{ marginTop: '20px' }}>\r\n                  Nessun cliente trovato.\r\n                </p>\r\n              )\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CustomersList;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}